const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/QRCodeSVG-ZmfxE8om.js","static/sanity-hHxQbr7i.js","static/LiveQueries-Bz5sENWb.js","static/DisplayedDocumentBroadcaster-BL7dCBqv.js","static/PostMessageDocuments-DEb4GIeN.js","static/PostMessageRefreshMutations-BhDq5GMu.js","static/PostMessagePerspective-wEopQOCH.js","static/PostMessagePreviewSnapshots-B809A43z.js","static/PostMessageSchema-BMzQnHiu.js","static/PostMessageTelemetry-BusKN-mD.js"])))=>i.map(i=>d[i]);
import{r as f,aT as It,aU as Cr,j as l,aV as Ar,aW as Tr,aX as kr,aY as Vt,aZ as Bt,a_ as Kt,a$ as Ht,b0 as Gt,b1 as qt,b2 as Xt,b3 as xt,b4 as bt,b5 as Ne,b6 as Be,b7 as Pt,b8 as St,b9 as He,ba as _t,bb as jt,at as Qt,bc as Mr,bd as Jt,be as Ir,bf as $r,a as W,bg as ee,bh as Yt,bi as Ur,u as nt,bj as Zt,bk as er,a9 as Ge,i as it,k as xe,bl as be,bm as tr,bn as rr,bo as nr,bp as Lr,bq as ir,br as Or,A as zr,bs as ar,n as Ye,bt as vt,bu as sr,a2 as Wr,bv as Dr,bw as Nr,F as ae,bx as Fr,l as Et,by as te,bz as Vr,bA as he,bB as at,bC as Br,bD as Kr,bE as Hr,bF as Gr,bG as qr,p as ge,bH as Rt,bI as Ct,bJ as Xr,bK as $t,bL as Qr,U as At,bM as Jr,bN as Yr,C as pe,bO as or,bP as qe,ae as Re,h as Ze,T as re,S as Ue,Y as et,f as tt,ag as Ce,bQ as Zr,bR as en,bS as tn,bT as rn,O as nn,o as ve,b as an,bU as st,bV as sn,bW as ot,bX as on,bY as cn,G as ln,bZ as Ke,b_ as cr,b$ as un,c0 as dn,t as pn,c1 as mn,M as hn,c2 as fn,c3 as vn,c4 as lr,ai as gn,c5 as wn,c6 as yn,c7 as xn,aJ as bn,q as Pn,c8 as Sn,an as ur,c9 as _n,a3 as dr,aK as pr,ar as jn,ca as En,cb as Rn,cc as Cn,cd as An,ce as Tn,cf as kn,cg as Mn}from"./sanity-hHxQbr7i.js";import{D as In,i as $n}from"./DisplayedDocumentBroadcaster-BL7dCBqv.js";function Un({children:r,isValidProp:e,...t}){e&&Ar(e),t={...f.useContext(It),...t},t.isStatic=Cr(()=>t.isStatic);const i=f.useMemo(()=>t,[JSON.stringify(t.transition),t.transformPagePoint,t.reducedMotion]);return l.jsx(It.Provider,{value:i,children:r})}const Ln={"handshake/syn":Xt,"handshake/syn-ack":qt,"handshake/ack":Gt,"channel/response":Ht,"channel/heartbeat":Kt,"channel/disconnect":Bt,"overlay/focus":"visual-editing/focus","overlay/navigate":"visual-editing/navigate","overlay/toggle":"visual-editing/toggle","presentation/toggleOverlay":"presentation/toggle-overlay"},On={[Xt]:"handshake/syn",[qt]:"handshake/syn-ack",[Gt]:"handshake/ack",[Ht]:"channel/response",[Kt]:"channel/heartbeat",[Bt]:"channel/disconnect","visual-editing/focus":"overlay/focus","visual-editing/navigate":"overlay/navigate","visual-editing/toggle":"overlay/toggle","presentation/toggle-overlay":"presentation/toggleOverlay"},zn=r=>{const{data:e}=r;return e&&typeof e=="object"&&"domain"in e&&"type"in e&&"from"in e&&"to"in e&&(e.domain==="sanity/channels"&&(e.domain=Vt),e.to==="overlays"&&(e.to="visual-editing"),e.from==="overlays"&&(e.from="visual-editing"),e.channelId=e.connectionId,delete e.connectionId,e.type=Ln[e.type]??e.type),r},Wn=r=>{const{channelId:e,...t}=r,i={...t,connectionId:e};return i.domain===Vt&&(i.domain="sanity/channels"),i.to==="visual-editing"&&(i.to="overlays"),i.from==="visual-editing"&&(i.from="overlays"),i.type=On[i.type]??i.type,i.type==="channel/response"&&i.responseTo&&!i.data&&(i.data={responseTo:i.responseTo}),(i.type==="handshake/syn"||i.type==="handshake/syn-ack"||i.type==="handshake/ack")&&(i.data={id:i.connectionId}),i},Dn=({context:r},e)=>{const{sources:t,targetOrigin:i}=r,a=Wn(e.message);t.forEach(n=>{n.postMessage(a,{targetOrigin:i})})},gt=()=>({listen:kr(zn),requestMachine:Tr().provide({actions:{"send message":Dn}})}),ie=[];for(let r=0;r<256;++r)ie.push((r+256).toString(16).slice(1));function Nn(r,e=0){return(ie[r[e+0]]+ie[r[e+1]]+ie[r[e+2]]+ie[r[e+3]]+"-"+ie[r[e+4]]+ie[r[e+5]]+"-"+ie[r[e+6]]+ie[r[e+7]]+"-"+ie[r[e+8]]+ie[r[e+9]]+"-"+ie[r[e+10]]+ie[r[e+11]]+ie[r[e+12]]+ie[r[e+13]]+ie[r[e+14]]+ie[r[e+15]]).toLowerCase()}let ut;const Fn=new Uint8Array(16);function Vn(){if(!ut){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ut=crypto.getRandomValues.bind(crypto)}return ut(Fn)}const Bn=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ut={randomUUID:Bn};function Kn(r,e,t){var a;if(Ut.randomUUID&&!r)return Ut.randomUUID();r=r||{};const i=r.random??((a=r.rng)==null?void 0:a.call(r))??Vn();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,Nn(i)}function Hn(r){const e=new URL(r),{searchParams:t}=e;return t.delete(xt),t.delete(bt),t.delete(Ne),t.delete(Be),t.delete(Pt),e}function Gn(r,e,t,i){const a=new URL(r),{searchParams:n}=a;return e&&(n.set(bt,e),n.set(xt,t)),n.set(Ne,i),a}function mr(){if(typeof crypto<"u"){const r=new Uint8Array(16);crypto.getRandomValues(r);let e="";for(let t=0;t<r.length;t++)e+=r[t].toString(16).padStart(2,"0");return e=btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]+$/,""),e}return Math.random().toString(36).slice(2)}async function qn(r,e,t,i){const a=r.withConfig({apiVersion:St}),n=mr(),s=a.patch(He).set({secret:n,studioUrl:t,userId:i});return await a.transaction().createIfNotExists({_id:He,_type:_t,source:e,studioUrl:t,userId:i}).patch(s).commit({tag:jt}),{secret:n}}async function Xn(r,e,t,i){const a=r.withConfig({apiVersion:St}),n=a.patch(He).set({secret:null,studioUrl:t,userId:i});await a.transaction().createIfNotExists({_id:He,_type:_t,source:e,studioUrl:t,userId:i}).patch(n).commit({tag:jt})}function Qn(r){for(var e=[],t=0;t<r.length;){var i=r[t];if(i==="*"||i==="+"||i==="?"){e.push({type:"MODIFIER",index:t,value:r[t++]});continue}if(i==="\\"){e.push({type:"ESCAPED_CHAR",index:t++,value:r[t++]});continue}if(i==="{"){e.push({type:"OPEN",index:t,value:r[t++]});continue}if(i==="}"){e.push({type:"CLOSE",index:t,value:r[t++]});continue}if(i===":"){for(var a="",n=t+1;n<r.length;){var s=r.charCodeAt(n);if(s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122||s===95){a+=r[n++];continue}break}if(!a)throw new TypeError("Missing parameter name at ".concat(t));e.push({type:"NAME",index:t,value:a}),t=n;continue}if(i==="("){var o=1,c="",n=t+1;if(r[n]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(n));for(;n<r.length;){if(r[n]==="\\"){c+=r[n++]+r[n++];continue}if(r[n]===")"){if(o--,o===0){n++;break}}else if(r[n]==="("&&(o++,r[n+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(n));c+=r[n++]}if(o)throw new TypeError("Unbalanced pattern at ".concat(t));if(!c)throw new TypeError("Missing pattern at ".concat(t));e.push({type:"PATTERN",index:t,value:c}),t=n;continue}e.push({type:"CHAR",index:t,value:r[t++]})}return e.push({type:"END",index:t,value:""}),e}function Jn(r,e){e===void 0&&(e={});for(var t=Qn(r),i=e.prefixes,a=i===void 0?"./":i,n=e.delimiter,s=n===void 0?"/#?":n,o=[],c=0,u=0,m="",d=function(C){if(u<t.length&&t[u].type===C)return t[u++].value},p=function(C){var R=d(C);if(R!==void 0)return R;var E=t[u],U=E.type,I=E.index;throw new TypeError("Unexpected ".concat(U," at ").concat(I,", expected ").concat(C))},h=function(){for(var C="",R;R=d("CHAR")||d("ESCAPED_CHAR");)C+=R;return C},x=function(C){for(var R=0,E=s;R<E.length;R++){var U=E[R];if(C.indexOf(U)>-1)return!0}return!1},w=function(C){var R=o[o.length-1],E=C||(R&&typeof R=="string"?R:"");if(R&&!E)throw new TypeError('Must have text between two parameters, missing text after "'.concat(R.name,'"'));return!E||x(E)?"[^".concat(Ie(s),"]+?"):"(?:(?!".concat(Ie(E),")[^").concat(Ie(s),"])+?")};u<t.length;){var v=d("CHAR"),g=d("NAME"),P=d("PATTERN");if(g||P){var S=v||"";a.indexOf(S)===-1&&(m+=S,S=""),m&&(o.push(m),m=""),o.push({name:g||c++,prefix:S,suffix:"",pattern:P||w(S),modifier:d("MODIFIER")||""});continue}var y=v||d("ESCAPED_CHAR");if(y){m+=y;continue}m&&(o.push(m),m="");var b=d("OPEN");if(b){var S=h(),_=d("NAME")||"",A=d("PATTERN")||"",j=h();p("CLOSE"),o.push({name:_||(A?c++:""),pattern:_&&!A?w(S):A,prefix:S,suffix:j,modifier:d("MODIFIER")||""});continue}p("END")}return o}function Yn(r,e){var t=[],i=fr(r,t,e);return Zn(i,t,e)}function Zn(r,e,t){t===void 0&&(t={});var i=t.decode,a=i===void 0?function(n){return n}:i;return function(n){var s=r.exec(n);if(!s)return!1;for(var o=s[0],c=s.index,u=Object.create(null),m=function(p){if(s[p]===void 0)return"continue";var h=e[p-1];h.modifier==="*"||h.modifier==="+"?u[h.name]=s[p].split(h.prefix+h.suffix).map(function(x){return a(x,h)}):u[h.name]=a(s[p],h)},d=1;d<s.length;d++)m(d);return{path:o,index:c,params:u}}}function Ie(r){return r.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function hr(r){return r&&r.sensitive?"":"i"}function ei(r,e){if(!e)return r;for(var t=/\((?:\?<(.*?)>)?(?!\?)/g,i=0,a=t.exec(r.source);a;)e.push({name:a[1]||i++,prefix:"",suffix:"",modifier:"",pattern:""}),a=t.exec(r.source);return r}function ti(r,e,t){var i=r.map(function(a){return fr(a,e,t).source});return new RegExp("(?:".concat(i.join("|"),")"),hr(t))}function ri(r,e,t){return ni(Jn(r,t),e,t)}function ni(r,e,t){t===void 0&&(t={});for(var i=t.strict,a=i===void 0?!1:i,n=t.start,s=n===void 0?!0:n,o=t.end,c=o===void 0?!0:o,u=t.encode,m=u===void 0?function(R){return R}:u,d=t.delimiter,p=d===void 0?"/#?":d,h=t.endsWith,x=h===void 0?"":h,w="[".concat(Ie(x),"]|$"),v="[".concat(Ie(p),"]"),g=s?"^":"",P=0,S=r;P<S.length;P++){var y=S[P];if(typeof y=="string")g+=Ie(m(y));else{var b=Ie(m(y.prefix)),_=Ie(m(y.suffix));if(y.pattern)if(e&&e.push(y),b||_)if(y.modifier==="+"||y.modifier==="*"){var A=y.modifier==="*"?"?":"";g+="(?:".concat(b,"((?:").concat(y.pattern,")(?:").concat(_).concat(b,"(?:").concat(y.pattern,"))*)").concat(_,")").concat(A)}else g+="(?:".concat(b,"(").concat(y.pattern,")").concat(_,")").concat(y.modifier);else{if(y.modifier==="+"||y.modifier==="*")throw new TypeError('Can not repeat "'.concat(y.name,'" without a prefix and suffix'));g+="(".concat(y.pattern,")").concat(y.modifier)}else g+="(?:".concat(b).concat(_,")").concat(y.modifier)}}if(c)a||(g+="".concat(v,"?")),g+=t.endsWith?"(?=".concat(w,")"):"$";else{var j=r[r.length-1],C=typeof j=="string"?v.indexOf(j[j.length-1])>-1:j===void 0;a||(g+="(?:".concat(v,"(?=").concat(w,"))?")),C||(g+="(?=".concat(v,"|").concat(w,")"))}return new RegExp(g,hr(t))}function fr(r,e,t){return r instanceof RegExp?ei(r,e):Array.isArray(r)?ti(r,e,t):ri(r,e,t)}async function ii(r,e,t,i,a=Qt()){const n=r.withConfig({apiVersion:St});try{const s=new Date(Date.now()+1e3*Mr),o=`drafts.${a}`,c=mr(),u=n.patch(o).set({secret:c,source:e,studioUrl:t,userId:i});return await n.transaction().createOrReplace({_id:o,_type:Jt}).patch(u).commit({tag:jt}),{secret:c,expiresAt:s}}finally{try{await n.delete({query:Ir})}catch(s){console.error("Failed to delete expired secrets",s)}}}function ai(r,e){let t=new AbortController,i=[];async function a(s,o){const{result:c,syncTags:u}=await r.fetch($r,{},{filterResponse:!1,lastLiveEventId:s,tag:"preview-url-secret.fetch-vercel-bypass-protection-secret"});Array.isArray(u)&&(i=u),o.aborted||e(c)}const n=r.live.events().subscribe({next:s=>{s.type==="message"&&(t.abort(),t=new AbortController,s.tags.some(o=>i.includes(o))&&a(s.id,t.signal))},error:s=>console.error(s)});return a(null,t.signal),()=>{n.unsubscribe(),t.abort()}}const si=r=>{const e=W.c(3),{comlink:t}=r;let i,a;return e[0]!==t?(i=()=>t.on("visual-editing/features",ci),a=[t],e[0]=t,e[1]=i,e[2]=a):(i=e[1],a=e[2]),f.useEffect(i,a),null};var oi=f.memo(si);function ci(){return{features:{optimistic:!0}}}const li=tr({actions:{},actors:{},guards:{}}).createMachine({id:"Presentation Tool",context:{url:null,error:null,visualEditingOverlaysEnabled:!1},on:{"iframe reload":{actions:te({url:null}),target:".loading"}},states:{error:{description:"Failed to load, either because of a misconfiguration, a network error, or an unexpected error",tags:["error"]},loading:{on:{"iframe loaded":{target:"loaded"}},tags:["busy"]},loaded:{on:{"toggle visual editing overlays":{actions:te({visualEditingOverlaysEnabled:({event:r})=>r.enabled})},"iframe refresh":{target:".refreshing"},"iframe reload":{target:".reloading"}},states:{idle:{},refreshing:{on:{"iframe loaded":{target:"idle"}},tags:["busy"]},reloading:{on:{"iframe loaded":{target:"idle"}},tags:["busy"]}},initial:"idle"}},initial:"loading"}),ui=function(r){const e=W.c(14),{comlink:t,children:i}=r;let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a={},e[0]=a):a=e[0];const n=f.useRef(a);let s,o;e[1]!==t?(s=()=>t==null?void 0:t.on("visual-editing/shared-state",()=>({state:n.current})),o=[t],e[1]=t,e[2]=s,e[3]=o):(s=e[2],o=e[3]),f.useEffect(s,o);let c;e[4]!==t?(c=(v,g)=>{n.current[v]=g,t==null||t.post("presentation/shared-state",{key:v,value:g})},e[4]=t,e[5]=c):c=e[5];const u=c;let m;e[6]!==t?(m=v=>{t==null||t.post("presentation/shared-state",{key:v}),delete n.current[v]},e[6]=t,e[7]=m):m=e[7];const d=m;let p,h;e[8]!==d||e[9]!==u?(h={removeValue:d,setValue:u},e[8]=d,e[9]=u,e[10]=h):h=e[10],p=h;const x=p;let w;return e[11]!==i||e[12]!==x?(w=l.jsx(qr.Provider,{value:x,children:i}),e[11]=i,e[12]=x,e[13]=w):w=e[13],w},di=ge.div`
  overflow: hidden;
  flex-basis: 0;
  flex-shrink: 1;
`,Tt=function(r){const e=W.c(15),{children:t,defaultSize:i,id:a,minWidth:n,maxWidth:s,order:o}=r,c=i===void 0?null:i,u=o===void 0?0:o,m=f.useContext(Rt);if(m===null)throw Error("Panel components must be rendered within a PanelGroup container");const{getPanelStyle:d,registerElement:p,unregisterElement:h}=m;let x;e[0]!==d||e[1]!==a?(x=d(a),e[0]=d,e[1]=a,e[2]=x):x=e[2];const w=x;let v,g;e[3]!==c||e[4]!==a||e[5]!==s||e[6]!==n||e[7]!==u||e[8]!==p||e[9]!==h?(v=()=>(p(a,{id:a,type:"panel",defaultSize:c,maxWidth:s??null,minWidth:n??0,order:u}),()=>{h(a)}),g=[a,c,u,s,n,p,h],e[3]=c,e[4]=a,e[5]=s,e[6]=n,e[7]=u,e[8]=p,e[9]=h,e[10]=v,e[11]=g):(v=e[10],g=e[11]),f.useLayoutEffect(v,g);let P;return e[12]!==t||e[13]!==w?(P=l.jsx(di,{style:w,children:t}),e[12]=t,e[13]=w,e[14]=P):P=e[14],P};function vr(r,e){let t;return(...i)=>{clearTimeout(t),t=setTimeout(()=>{r.apply(r,i)},e)}}const gr="presentation/panels",wr=()=>JSON.parse(localStorage.getItem(gr)||"{}"),pi=r=>{localStorage.setItem(gr,JSON.stringify(r))},yr=r=>r.map(e=>[e.id,e.order].join(":")).join(",");function mi(){const r=W.c(1);let e;const t=fi,i=hi;let a;if(r[0]===Symbol.for("react.memo_cache_sentinel")){const n=vr(i,100);a={get:t,set:i,setDebounced:n},r[0]=a}else a=r[0];return e=a,e}function hi(r,e){const t=wr(),i=yr(r),a={...t,[i]:e};pi(a)}function fi(r){const e=wr(),t=yr(r);return Array.isArray(e[t])&&e[t].some(vi)?void 0:e[t]}function vi(r){return r===null}function wt(r,e,t){const{maxWidth:i,minWidth:a}=r,n=i==null?100:i/t*100,s=a/t*100;return Math.min(n,Math.max(s,e))}function gi(r,e,t,i,a,n){const{panels:s,widths:o}=a,{widths:c}=n,u=c||o,m=[...u];{const x=r<0?i:t,w=s.findIndex(P=>P.id===x.id),v=u[w],g=wt(x,v+Math.abs(r),e);if(v===g)return u;r=r<0?v-g:g-v}let d=0,p=r<0?t:i,h=s.findIndex(x=>x.id===p.id);for(;;){const x=s[h],w=u[h],v=Math.abs(r)-Math.abs(d),g=wt(x,w-v,e);if(w!==g&&(d+=w-g,m[h]=g,d.toPrecision(10).localeCompare(Math.abs(r).toPrecision(10),void 0,{numeric:!0})>=0))break;if(r<0){if(--h<0)break}else if(++h>=s.length)break}return d===0?u:(p=r<0?i:t,h=s.findIndex(x=>x.id===p.id),m[h]=u[h]+d,m)}function wi(r,e,t){if(r.length===1)return"100";const i=r.findIndex(n=>n.id===e),a=t[i];return a==null?"0":a.toPrecision(10)}function Lt(r,e,t=0,i=null){const a=r.clientX,n=(i||e.getBoundingClientRect()).left;return a-n-t}function dt(r){return r.type==="panel"}function Ot(r){return r.type==="resizer"}function zt(r){return Array.from(r.values()).sort(({order:e},{order:t})=>e==null&&t==null?0:e==null?-1:t==null?1:e-t)}function Wt(r,e,t){const i=e.reduce((s,o)=>s+o,0),a=[...e].map(s=>s/i*100);let n=0;for(let s=0;s<r.length;s++){const o=r[s],c=a[s],u=wt(o,c,t);c!=u&&(n+=c-u,a[s]=u)}if(n.toFixed(3)!=="0.000")for(let s=0;s<r.length;s++){const o=r[s];let{maxWidth:c,minWidth:u}=o;u=u/t*100,c!=null&&(c=c/t*100);const m=Math.min(c??100,Math.max(u,a[s]+n));if(m!==a[s]&&(n-=m-a[s],a[s]=m,Math.abs(n).toFixed(3)==="0.000"))break}return a}function yi(r){let e=r.length,t=100;const i=r.map(n=>n.defaultSize?(t-=n.defaultSize,e-=1,n.defaultSize):null),a=t/e;return i.map(n=>n===null?a:n)}const xi=ge.div`
  display: flex;
  flex-direction: row;
  height: 100%;
  overflow: hidden;
  width: 100%;
`,bi=function(r){const e=W.c(46),{children:t}=r,i=f.useRef(null);let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=new Map,e[0]=a):a=e[0];const[n,s]=f.useState(a);let o,c;e[1]!==n?(c=zt(n).filter(dt),e[1]=n,e[2]=c):c=e[2],o=c;const u=o;let m;e[3]===Symbol.for("react.memo_cache_sentinel")?(m=[],e[3]=m):m=e[3];const[d,p]=f.useState(m),[h,x]=f.useState(null);let w;e[4]!==n||e[5]!==u||e[6]!==d?(w={elements:n,panels:u,widths:d},e[4]=n,e[5]=u,e[6]=d,e[7]=w):w=e[7];const v=f.useRef(w);let g;e[8]!==h||e[9]!==u||e[10]!==d?(g=F=>({flexGrow:wi(u,F,d),pointerEvents:h===null?void 0:"none"}),e[8]=h,e[9]=u,e[10]=d,e[11]=g):g=e[11];const P=g;let S;e[12]===Symbol.for("react.memo_cache_sentinel")?(S=(F,K)=>{s(H=>{if(H.has(F))return H;const J=new Map(H);return J.set(F,K),J})},e[12]=S):S=e[12];const y=S;let b;e[13]===Symbol.for("react.memo_cache_sentinel")?(b=F=>{s(K=>{if(!K.has(F))return K;const H=new Map(K);return H.delete(F),H})},e[13]=b):b=e[13];const _=b;let A;e[14]===Symbol.for("react.memo_cache_sentinel")?(A={containerWidth:window.innerWidth,dragOffset:0,panelAfter:null,panelBefore:null,resizerIndex:-1,resizerRect:null,startX:0,widths:[]},e[14]=A):A=e[14];const j=f.useRef(A);let C;e[15]!==n?(C=(F,K)=>{const H=zt(n),J=H.findIndex(N=>N.id===F),$=n.get(F);if(!$||!Ot($))return;const V=$.el.current;V&&(j.current={resizerIndex:J,panelBefore:H.reduce((N,Z,le)=>dt(Z)&&le<J?Z:N,null),panelAfter:H.reduce((N,Z,le)=>N===null&&dt(Z)&&le>J?Z:N,null),containerWidth:window.innerWidth,startX:K.pageX,dragOffset:Lt(K,V),resizerRect:V.getBoundingClientRect(),widths:v.current.widths},x(F))},e[15]=n,e[16]=C):C=e[16];const R=C;let E;e[17]===Symbol.for("react.memo_cache_sentinel")?(E=()=>{x(null)},e[17]=E):E=e[17];const U=E;let I;e[18]!==n?(I=(F,K)=>{K.preventDefault(),K.stopPropagation();const{containerWidth:H,dragOffset:J,panelBefore:$,panelAfter:V,resizerRect:N}=j.current;if($==null||V==null)return;const Z=n.get(F);if(!Z||!Ot(Z))return;const le=Z.el.current;if(!le)return;const me=Lt(K,le,J,N);if(me===0)return;const{widths:Ae}=v.current,Pe=i.current.getBoundingClientRect(),Se=me/Pe.width*100,fe=gi(Se,H,$,V,v.current,j.current);Ae.some((_e,we)=>_e!==fe[we])&&p(fe)},e[18]=n,e[19]=I):I=e[19];const T=I;let k,z;e[20]!==n||e[21]!==u||e[22]!==d?(k=()=>{v.current.elements=n,v.current.panels=u,v.current.widths=d},z=[n,u,d],e[20]=n,e[21]=u,e[22]=d,e[23]=k,e[24]=z):(k=e[23],z=e[24]),f.useLayoutEffect(k,z);const D=mi();let B,X;e[25]!==u||e[26]!==D?(B=()=>{const{widths:F}=v.current;if(F.length===u.length)return;const K=D.get(u);if(K){const J=Wt(u,K,window.innerWidth);p(J);return}const H=yi(u);p(H)},X=[D,u],e[25]=u,e[26]=D,e[27]=B,e[28]=X):(B=e[27],X=e[28]),f.useLayoutEffect(B,X);let se,G;e[29]!==u||e[30]!==D||e[31]!==d?(se=()=>{d.length&&D.setDebounced(u,d)},G=[D,u,d],e[29]=u,e[30]=D,e[31]=d,e[32]=se,e[33]=G):(se=e[32],G=e[33]),f.useEffect(se,G);let q,ue;e[34]===Symbol.for("react.memo_cache_sentinel")?(q=()=>{const F=new ResizeObserver(()=>{const{panels:K,widths:H}=v.current,J=Wt(K,H,window.innerWidth);H.some(($,V)=>$!==J[V])&&p(J)});return F.observe(i.current),()=>{F.disconnect()}},ue=[],e[34]=q,e[35]=ue):(q=e[34],ue=e[35]),f.useLayoutEffect(q,ue);let Q,ne;e[36]!==h||e[37]!==T||e[38]!==P||e[39]!==R?(ne={activeResizer:h,drag:T,getPanelStyle:P,registerElement:y,startDragging:R,stopDragging:U,unregisterElement:_},e[36]=h,e[37]=T,e[38]=P,e[39]=R,e[40]=ne):ne=e[40],Q=ne;const oe=Q;let Y;e[41]!==t?(Y=l.jsx(xi,{ref:i,children:t}),e[41]=t,e[42]=Y):Y=e[42];let ce;return e[43]!==oe||e[44]!==Y?(ce=l.jsx(Rt.Provider,{value:oe,children:Y}),e[43]=oe,e[44]=Y,e[45]=ce):ce=e[45],ce};function kt(r){const e=W.c(37);let t,i,a,n,s;e[0]!==r?({children:t,message:i,onRetry:n,onContinueAnyway:a,...s}=r,e[0]=r,e[1]=t,e[2]=i,e[3]=a,e[4]=n,e[5]=s):(t=e[1],i=e[2],a=e[3],n=e[4],s=e[5]);const{t:o}=xe(be);let c;e[6]!==o?(c=o("error-card.retry-button.text"),e[6]=o,e[7]=c):c=e[7];let u;e[8]!==n||e[9]!==c?(u=l.jsx(Re,{mode:"ghost",onClick:n,text:c}),e[8]=n,e[9]=c,e[10]=u):u=e[10];const m=u;let d;e[11]!==o?(d=o("error-card.continue-button.text"),e[11]=o,e[12]=d):d=e[12];let p;e[13]!==a||e[14]!==d?(p=l.jsx(Re,{mode:"ghost",tone:"critical",onClick:a,text:d}),e[13]=a,e[14]=d,e[15]=p):p=e[15];const h=p;let x;e[16]!==o?(x=o("error-card.title"),e[16]=o,e[17]=x):x=e[17];let w;e[18]!==x?(w=l.jsx(re,{size:1,weight:"semibold",children:x}),e[18]=x,e[19]=w):w=e[19];let v;e[20]!==i?(v=l.jsx(re,{muted:!0,size:1,children:i}),e[20]=i,e[21]=v):v=e[21];let g;e[22]!==w||e[23]!==v?(g=l.jsxs(Ue,{space:3,children:[w,v]}),e[22]=w,e[23]=v,e[24]=g):g=e[24];let P;e[25]!==h||e[26]!==a||e[27]!==n||e[28]!==m?(P=n&&a?l.jsxs(nn,{space:2,children:[m,h]}):n?l.jsx(ve,{children:m}):a?l.jsx(ve,{children:h}):null,e[25]=h,e[26]=a,e[27]=n,e[28]=m,e[29]=P):P=e[29];let S;e[30]!==t||e[31]!==g||e[32]!==P?(S=l.jsx(ae,{align:"center",height:"fill",justify:"center",children:l.jsx(an,{padding:4,sizing:"border",width:0,children:l.jsxs(Ue,{space:4,children:[g,t,P]})})}),e[30]=t,e[31]=g,e[32]=P,e[33]=S):S=e[33];let y;return e[34]!==s||e[35]!==S?(y=l.jsx(pe,{height:"fill",...s,children:S}),e[34]=s,e[35]=S,e[36]=y):y=e[36],y}function Pi(r={}){const e=Object.entries(r).map(([t,i])=>`${t}=${i}`).join("&");return e.length?`?${e}`:""}function Si(r){const e=["comment","inspect","instruction","pathKey","rev","since","template","view"],t=Object.entries(r).filter(([i])=>e.includes(i)).reduce((i,[a,n])=>n==null?i:{...i,[a]:n},{});return Pi(t)}const _i=f.forwardRef(function(r,e){const t=W.c(11);let i,a;t[0]!==r?({searchParams:a,...i}=r,t[0]=r,t[1]=i,t[2]=a):(i=t[1],a=t[2]);let n;t[3]!==a?(n=Object.entries(a),t[3]=a,t[4]=n):n=t[4];let s;t[5]!==n?(s={type:void 0,_searchParams:n},t[5]=n,t[6]=s):s=t[6];let o;return t[7]!==e||t[8]!==i||t[9]!==s?(o=l.jsx(st,{...i,ref:e,state:s,title:void 0}),t[7]=e,t[8]=i,t[9]=s,t[10]=o):o=t[10],o}),ji=f.forwardRef(function(r,e){const t=W.c(15);let i,a,n,s;if(t[0]!==r){const{documentId:m,documentType:d,parentRefPath:p,template:h,searchParams:x,...w}=r;i=m,a=d,s=x,n=w,t[0]=r,t[1]=i,t[2]=a,t[3]=n,t[4]=s}else i=t[1],a=t[2],n=t[3],s=t[4];let o;t[5]!==s?(o=Object.entries(s),t[5]=s,t[6]=o):o=t[6];let c;t[7]!==i||t[8]!==a||t[9]!==o?(c={id:i,type:a,_searchParams:o},t[7]=i,t[8]=a,t[9]=o,t[10]=c):c=t[10];let u;return t[11]!==e||t[12]!==n||t[13]!==c?(u=l.jsx(st,{...n,ref:e,state:c,title:void 0}),t[11]=e,t[12]=n,t[13]=c,t[14]=u):u=t[14],u});function xr(r){const e=W.c(26),{children:t,onStructureParams:i,structureParams:a,searchParams:n,refs:s}=r,{state:o,resolvePathFromState:c}=Ge();let u;e[0]!==o._searchParams?(u=Object.fromEntries(o._searchParams||[]),e[0]=o._searchParams,e[1]=u):u=e[1];const m=ir(u);let d;e[2]!==c||e[3]!==m||e[4]!==o?(d=j=>{const C=c(o),R=Si({...m,...j});return`${C}${R}`},e[2]=c,e[3]=m,e[4]=o,e[5]=d):d=e[5];const p=d;let h,x;e[6]===Symbol.for("react.memo_cache_sentinel")?(x={},e[6]=x):x=e[6];const w=a;let v;e[7]===Symbol.for("react.memo_cache_sentinel")?(v=[],e[7]=v):v=e[7];let g;e[8]!==s||e[9]!==n?(g=j=>{const{childId:C,...R}=j,E=s==null?void 0:s.find(U=>U._id===C||at(U._id)===C);return E?l.jsx(st,{...R,state:{id:C,type:E._type,_searchParams:Object.entries(n)}}):l.jsx("div",{...R})},e[8]=s,e[9]=n,e[10]=g):g=e[10];let P,S;e[11]!==n?(P=j=>l.jsx(_i,{...j,searchParams:n}),S=j=>l.jsx(ji,{...j,searchParams:n}),e[11]=n,e[12]=P,e[13]=S):(P=e[12],S=e[13]);let y;e[14]!==i?(y=j=>{i({...j,inspect:j.inspect??void 0})},e[14]=i,e[15]=y):y=e[15];let b;e[16]!==p||e[17]!==w||e[18]!==g||e[19]!==P||e[20]!==S||e[21]!==y?(b={index:0,groupIndex:0,siblingIndex:0,payload:x,params:w,hasGroupSiblings:!1,groupLength:1,routerPanesState:v,ChildLink:g,BackLink:P,ReferenceChildLink:S,ParameterizedLink:$i,closeCurrentAndAfter:Ii,handleEditReference:Mi,replaceCurrent:ki,closeCurrent:Ti,duplicateCurrent:Ai,setView:Ci,setParams:y,setPayload:Ri,navigateIntent:Ei,createPathWithParams:p},e[16]=p,e[17]=w,e[18]=g,e[19]=P,e[20]=S,e[21]=y,e[22]=b):b=e[22],h=b;const _=h;let A;return e[23]!==t||e[24]!==_?(A=l.jsx(jn.Provider,{value:_,children:t}),e[23]=t,e[24]=_,e[25]=A):A=e[25],A}function Ei(r,e,t){console.warn("navigateIntent",r,e,t)}function Ri(r){console.warn("setPayload",r)}function Ci(r){console.warn("setView",r)}function Ai(r){console.warn("duplicateCurrent",r)}function Ti(){console.warn("closeCurrent")}function ki(r){console.warn("replaceCurrent",r)}function Mi(r){console.warn("handleEditReference",r)}function Ii(){console.warn("closeCurrentAndAfter")}function $i(){throw new Error("ParameterizedLink not implemented")}const Ui=ge(pr)`
  height: 100%;
`,Li=ge(ae)`
  & > div {
    min-width: none !important;
    max-width: none !important;
  }
`,Oi=ge(tt)`
  white-space: pre-wrap;
`;function zi(r){var C,R,E,U;const e=W.c(33),{mainDocumentState:t,onStructureParams:i,searchParams:a,refs:n}=r,{t:s}=xe(be),{devMode:o}=Ct();let c,u;if(e[0]!==((C=t==null?void 0:t.document)==null?void 0:C._id)||e[1]!==n){let I;e[3]!==((R=t==null?void 0:t.document)==null?void 0:R._id)?(I=T=>{var k;return at(T._id)!==((k=t==null?void 0:t.document)==null?void 0:k._id)},e[3]=(E=t==null?void 0:t.document)==null?void 0:E._id,e[4]=I):I=e[4],u=n.filter(I).map(Di),e[0]=(U=t==null?void 0:t.document)==null?void 0:U._id,e[1]=n,e[2]=u}else u=e[2];c=u;const m=c;let d,p;e[5]!==m?(p={filter:"_id in $ids",params:{ids:m}},e[5]=m,e[6]=p):p=e[6];let h;e[7]!==s?(h=s("document-list-pane.document-list.title"),e[7]=s,e[8]=h):h=e[8];let x;e[9]!==p||e[10]!==h?(x={id:"$root",options:p,schemaTypeName:"",title:h,type:"documentList"},e[9]=p,e[10]=h,e[11]=x):x=e[11],d=x;const w=d,[v,g]=f.useState(null);let P;e[12]===Symbol.for("react.memo_cache_sentinel")?(P=()=>g(null),e[12]=P):P=e[12];const S=P,[y]=f.useState(Wi);let b;e[13]===Symbol.for("react.memo_cache_sentinel")?(b=()=>g(null),e[13]=b):b=e[13];let _;if(e[14]!==n?(_=[n],e[14]=n,e[15]=_):_=e[15],f.useEffect(b,_),v){let I;e[16]!==s?(I=s("document-list-pane.error.text"),e[16]=s,e[17]=I):I=e[17];let T;e[18]!==o||e[19]!==v||e[20]!==s?(T=o&&l.jsx(pe,{overflow:"auto",padding:3,radius:2,tone:"critical",children:l.jsxs(Ue,{space:3,children:[l.jsx(et,{muted:!0,size:0,children:s("presentation-error.label")}),l.jsx(Oi,{size:1,children:v.error.message})]})}),e[18]=o,e[19]=v,e[20]=s,e[21]=T):T=e[21];let k;return e[22]!==T||e[23]!==I?(k=l.jsx(kt,{flex:1,message:I,onRetry:S,children:T}),e[22]=T,e[23]=I,e[24]=k):k=e[24],k}let A;e[25]!==w?(A=l.jsx(Li,{direction:"column",flex:1,children:l.jsx(Mn,{index:0,itemId:"$root",pane:w,paneKey:"$root"})}),e[25]=w,e[26]=A):A=e[26];let j;return e[27]!==i||e[28]!==n||e[29]!==a||e[30]!==y||e[31]!==A?(j=l.jsx(dr,{onCatch:g,children:l.jsx(Ui,{children:l.jsx(ur,{children:l.jsx(xr,{onStructureParams:i,structureParams:y,searchParams:a,refs:n,children:A})})})}),e[27]=i,e[28]=n,e[29]=a,e[30]=y,e[31]=A,e[32]=j):j=e[32],j}function Wi(){return{}}function Di(r){return at(r._id)}const Ni=ge(tt)`
  white-space: pre-wrap;
`;function Fi(r){const e=W.c(35),{documentId:t,documentType:i,onFocusPath:a,onStructureParams:n,searchParams:s,structureParams:o}=r,{template:c,templateParams:u}=o,{t:m}=xe(be),{devMode:d}=Ct();let p,h;e[0]!==u?(h=_n(u),e[0]=u,e[1]=h):h=e[1];let x;e[2]!==t||e[3]!==i||e[4]!==h||e[5]!==c?(x={id:t,type:i,template:c,templateParameters:h},e[2]=t,e[3]=i,e[4]=h,e[5]=c,e[6]=x):x=e[6];let w;e[7]!==t||e[8]!==x?(w={id:t,options:x,title:"",type:"document"},e[7]=t,e[8]=x,e[9]=w):w=e[9],p=w;const v=p,[g,P]=f.useState(null);let S;e[10]===Symbol.for("react.memo_cache_sentinel")?(S=()=>P(null),e[10]=S):S=e[10];const y=S;let b;e[11]===Symbol.for("react.memo_cache_sentinel")?(b=()=>{P(null)},e[11]=b):b=e[11];let _;if(e[12]!==t||e[13]!==i||e[14]!==o?(_=[t,i,o],e[12]=t,e[13]=i,e[14]=o,e[15]=_):_=e[15],f.useEffect(b,_),g){let E;e[16]!==m?(E=m("document-pane.error.text"),e[16]=m,e[17]=E):E=e[17];let U;e[18]!==d||e[19]!==g||e[20]!==m?(U=d&&l.jsx(pe,{overflow:"auto",padding:3,radius:2,tone:"critical",children:l.jsxs(Ue,{space:3,children:[l.jsx(et,{muted:!0,size:0,children:m("presentation-error.label")}),l.jsx(Ni,{size:1,children:g.error.message})]})}),e[18]=d,e[19]=g,e[20]=m,e[21]=U):U=e[21];let I;return e[22]!==E||e[23]!==U?(I=l.jsx(kt,{flex:1,message:E,onRetry:y,children:U}),e[22]=E,e[23]=U,e[24]=I):I=e[24],I}let A;e[25]===Symbol.for("react.memo_cache_sentinel")?(A={height:"100%"},e[25]=A):A=e[25];let j;e[26]===Symbol.for("react.memo_cache_sentinel")?(j=l.jsx(Yt,{}),e[26]=j):j=e[26];let C;e[27]!==a||e[28]!==v?(C=l.jsx(f.Suspense,{fallback:j,children:l.jsx(En,{paneKey:"document",index:1,itemId:"document",pane:v,onFocusPath:a})}),e[27]=a,e[28]=v,e[29]=C):C=e[29];let R;return e[30]!==n||e[31]!==s||e[32]!==o||e[33]!==C?(R=l.jsx(dr,{onCatch:P,children:l.jsx(pr,{style:A,children:l.jsx(xr,{searchParams:s,onStructureParams:n,structureParams:o,children:C})})}),e[30]=n,e[31]=s,e[32]=o,e[33]=C,e[34]=R):R=e[34],R}function Vi(r){const e=W.c(7),{documentId:t,documentType:i,onFocusPath:a,onStructureParams:n,searchParams:s,structureParams:o}=r;let c;return e[0]!==t||e[1]!==i||e[2]!==a||e[3]!==n||e[4]!==s||e[5]!==o?(c=l.jsx(ur,{children:l.jsx(Fi,{documentId:t,documentType:i,onFocusPath:a,onStructureParams:n,searchParams:s,structureParams:o})}),e[0]=t,e[1]=i,e[2]=a,e[3]=n,e[4]=s,e[5]=o,e[6]=c):c=e[6],c}function Bi(r,e){const t=W.c(7),i=Sn();let a;t[0]===Symbol.for("react.memo_cache_sentinel")?(a={},t[0]=a):a=t[0];const[n,s]=f.useState(a),{perspectiveStack:o}=Et();let c,u;return t[1]!==r||t[2]!==i||t[3]!==o||t[4]!==e?(c=()=>{if(!e)return;const m=Rn(i,e,r,o).subscribe(d=>{s(d)});return()=>{m==null||m.unsubscribe()}},u=[i,e,r,o],t[1]=r,t[2]=i,t[3]=o,t[4]=e,t[5]=c,t[6]=u):(c=t[5],u=t[6]),f.useEffect(c,u),n}function Ki(r){var A,j,C,R,E,U,I,T;const e=W.c(38),{documentId:t,documentType:i,mainDocumentState:a,onFocusPath:n,onStructureParams:s,refs:o,searchParams:c,structureParams:u}=r,{t:m}=xe(be),d=gn();let p;e[0]!==((A=a==null?void 0:a.document)==null?void 0:A._id)||e[1]!==((j=a==null?void 0:a.document)==null?void 0:j._type)||e[2]!==c?(p=k=>{var z,D;return l.jsx(st,{...k,state:{id:(z=a==null?void 0:a.document)==null?void 0:z._id,type:(D=a==null?void 0:a.document)==null?void 0:D._type,_searchParams:Object.entries(c)}})},e[0]=(C=a==null?void 0:a.document)==null?void 0:C._id,e[1]=(R=a==null?void 0:a.document)==null?void 0:R._type,e[2]=c,e[3]=p):p=e[3];const h=p;let x,w;e[4]!==((E=a==null?void 0:a.document)==null?void 0:E._type)||e[5]!==d?(w=d.get(((U=a==null?void 0:a.document)==null?void 0:U._type)||"shoe"),e[4]=(I=a==null?void 0:a.document)==null?void 0:I._type,e[5]=d,e[6]=w):w=e[6],x=w;const v=x,g=Bi(((T=a==null?void 0:a.document)==null?void 0:T._id)||"",v);let P;e:{if(!(a!=null&&a.document)){P=null;break e}let k;e[7]!==a.document||e[8]!==g.snapshot?(k=wn({snapshot:g.snapshot,fallback:a.document}),e[7]=a.document,e[8]=g.snapshot,e[9]=k):k=e[9];let z;e[10]!==m?(z=m("main-document.label"),e[10]=m,e[11]=z):z=e[11];let D;e[12]!==z?(D=l.jsx(pe,{padding:1,radius:2,shadow:1,children:l.jsx(re,{muted:!0,size:0,weight:"medium",children:z})}),e[12]=z,e[13]=D):D=e[13];let B;e[14]!==v||e[15]!==k||e[16]!==D?(B=l.jsx(yn,{...k,schemaType:v,status:D}),e[14]=v,e[15]=k,e[16]=D,e[17]=B):B=e[17],P=B}const S=P;if(t&&i){let k;return e[18]!==t||e[19]!==i||e[20]!==n||e[21]!==s||e[22]!==c||e[23]!==u?(k=l.jsx(Vi,{documentId:t,documentType:i,onFocusPath:n,onStructureParams:s,searchParams:c,structureParams:u}),e[18]=t,e[19]=i,e[20]=n,e[21]=s,e[22]=c,e[23]=u,e[24]=k):k=e[24],k}let y;e[25]!==h||e[26]!==a||e[27]!==S||e[28]!==m?(y=a&&l.jsx(pe,{padding:3,tone:a.document?"inherit":"caution",children:a.document?l.jsx(xn,{__unstable_focusRing:!0,as:h,"data-as":"a",radius:2,sizing:"border",tone:"inherit",children:S}):l.jsx(pe,{padding:2,radius:2,tone:"inherit",children:l.jsxs(ae,{gap:3,children:[l.jsx(ve,{flex:"none",children:l.jsx(re,{size:1,children:l.jsx(bn,{})})}),l.jsx(ve,{flex:1,children:l.jsx(re,{size:1,children:l.jsx(At,{t:m,i18nKey:"main-document.missing.text",components:{Code:"code"},values:{path:a.path}})})})]})})}),e[25]=h,e[26]=a,e[27]=S,e[28]=m,e[29]=y):y=e[29];let b;e[30]!==a||e[31]!==s||e[32]!==o||e[33]!==c?(b=l.jsx(zi,{mainDocumentState:a,onStructureParams:s,searchParams:c,refs:o}),e[30]=a,e[31]=s,e[32]=o,e[33]=c,e[34]=b):b=e[34];let _;return e[35]!==y||e[36]!==b?(_=l.jsxs(ae,{direction:"column",flex:1,height:"fill",children:[y,b]}),e[35]=y,e[36]=b,e[37]=_):_=e[37],_}function Hi(r){const e=W.c(2);let t;e[0]!==r?(t=()=>r||Kn(),e[0]=r,e[1]=t):t=e[1];const[i]=f.useState(t);return i}const Gi=ge.div`
  position: relative;
`,qi=ge.div`
  position: absolute;
  top: 0;
  bottom: 0;
  left: -5px;
  width: 9px;
  z-index: 10;
  cursor: ${({$disabled:r})=>r?"auto":"ew-resize"};

  /* Border */
  & > span:nth-child(1) {
    display: block;
    border-left: 1px solid var(--card-border-color);
    position: absolute;
    top: 0;
    left: 4px;
    bottom: 0;
    transition: opacity 200ms;
  }

  ${({$disabled:r})=>!r&&`
    /* Hover effect */
    & > span:nth-child(2) {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 9px;
      bottom: 0;
      background-color: var(--card-border-color);
      opacity: 0;
      transition: opacity 150ms;
    }

    @media (hover: hover) {
      &:hover > span:nth-child(2) {
        opacity: 0.2;
      }
    }
  `}
`,br=function(r){const e=W.c(27),{id:t,order:i,disabled:a}=r,n=a===void 0?!1:a,s=f.useRef(null),o=f.useContext(Rt);if(o===null)throw Error("Panel components must be rendered within a PanelGroup container");const c=Hi(t),{activeResizer:u,drag:m,startDragging:d,stopDragging:p,registerElement:h,unregisterElement:x}=o,w=u===c;if(o===null)throw Error("Panel components must be rendered within a PanelGroup container");let v;e[0]!==c||e[1]!==d?(v=T=>{d(c,T.nativeEvent)},e[0]=c,e[1]=d,e[2]=v):v=e[2];const g=v;let P;e[3]!==m||e[4]!==c?(P=T=>{m(c,T)},e[3]=m,e[4]=c,e[5]=P):P=e[5];const S=P;let y;e[6]!==p?(y=()=>{s.current.blur(),p()},e[6]=p,e[7]=y):y=e[7];const b=y;let _,A;e[8]!==n||e[9]!==w||e[10]!==S||e[11]!==b?(_=()=>{if(!w||n)return;const T=function(){const k=document.body.style,z=document.documentElement.style,{cursor:D}=z,{userSelect:B}=k;return z.cursor="ew-resize",k.userSelect="none",()=>{D?z.cursor=D:z.removeProperty("cursor"),B?k.userSelect=B:k.removeProperty("user-select")}}();return window.addEventListener("mousemove",S),window.addEventListener("mouseup",b),window.addEventListener("contextmenu",b),()=>{T(),window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",b),window.removeEventListener("contextmenu",b)}},A=[n,w,S,b],e[8]=n,e[9]=w,e[10]=S,e[11]=b,e[12]=_,e[13]=A):(_=e[12],A=e[13]),f.useEffect(_,A);let j,C;e[14]!==c||e[15]!==i||e[16]!==h||e[17]!==x?(j=()=>(h(c,{id:c,order:i,type:"resizer",el:s}),()=>{x(c)}),C=[c,i,h,x],e[14]=c,e[15]=i,e[16]=h,e[17]=x,e[18]=j,e[19]=C):(j=e[18],C=e[19]),f.useLayoutEffect(j,C);let R,E;e[20]===Symbol.for("react.memo_cache_sentinel")?(E=l.jsx("span",{}),R=l.jsx("span",{}),e[20]=R,e[21]=E):(R=e[20],E=e[21]);let U;e[22]!==n?(U=l.jsxs(qi,{$disabled:n,children:[E,R]}),e[22]=n,e[23]=U):U=e[23];let I;return e[24]!==g||e[25]!==U?(I=l.jsx(Gi,{onMouseDown:g,ref:s,children:U}),e[24]=g,e[25]=U,e[26]=I):I=e[26],I},Xi=r=>{const e=W.c(8),{documentId:t,setDisplayedDocument:i,getCommentIntent:a}=r;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=l.jsx(br,{order:4}),e[0]=n):n=e[0];let s;e[1]!==a||e[2]!==r.children?(s=l.jsx(Zr,{getIntent:a,children:r.children}),e[1]=a,e[2]=r.children,e[3]=s):s=e[3];let o;return e[4]!==t||e[5]!==i||e[6]!==s?(o=l.jsxs(l.Fragment,{children:[n,l.jsx(Tt,{id:"content",minWidth:325,order:5,children:l.jsx(In,{documentId:t,setDisplayedDocument:i,children:s})})]}),e[4]=t,e[5]=i,e[6]=s,e[7]=o):o=e[7],o},Qi=r=>{const e=W.c(14),{documentId:t,documentsOnPage:i,documentType:a,getCommentIntent:n,mainDocumentState:s,onFocusPath:o,onStructureParams:c,searchParams:u,setDisplayedDocument:m,structureParams:d}=r;let p;e[0]!==t||e[1]!==a||e[2]!==i||e[3]!==s||e[4]!==o||e[5]!==c||e[6]!==u||e[7]!==d?(p=l.jsx(Ki,{documentId:t,documentType:a,mainDocumentState:s,onFocusPath:o,onStructureParams:c,refs:i,searchParams:u,structureParams:d}),e[0]=t,e[1]=a,e[2]=i,e[3]=s,e[4]=o,e[5]=c,e[6]=u,e[7]=d,e[8]=p):p=e[8];let h;return e[9]!==t||e[10]!==n||e[11]!==m||e[12]!==p?(h=l.jsx(Xi,{documentId:t,getCommentIntent:n,setDisplayedDocument:m,children:p}),e[9]=t,e[10]=n,e[11]=m,e[12]=p,e[13]=h):h=e[13],h},Ji=function(r){const e=W.c(5),{children:t,navigate:i}=r;let a;e[0]!==i?(a=(o,c)=>{i((c===void 0?void 0:c)||{},o?{preview:o}:{})},e[0]=i,e[1]=a):a=e[1];const n=a;let s;return e[2]!==t||e[3]!==n?(s=l.jsx(Hr.Provider,{value:n,children:t}),e[2]=t,e[3]=n,e[4]=s):s=e[4],s};function Yi(r,e){const t=W.c(9);let i;t[0]!==e||t[1]!==r?(i=()=>JSON.parse(localStorage.getItem(r)??JSON.stringify(e)),t[0]=e,t[1]=r,t[2]=i):i=t[2];const[a,n]=f.useState(i);let s,o;t[3]!==r||t[4]!==a?(s=()=>{localStorage.setItem(r,JSON.stringify(a))},o=[r,a],t[3]=r,t[4]=a,t[5]=s,t[6]=o):(s=t[5],o=t[6]),f.useEffect(s,o);let c;return t[7]!==a?(c=[a,n],t[7]=a,t[8]=c):c=t[8],c}function Zi(r){const e=W.c(11),{unstable_navigator:t}=r,i=!!(t!=null&&t.component),[a,n]=Yi("presentation/navigator",i),s=i?a:!1;let o;e:{if(!i){o=void 0;break e}let h;e[0]!==n?(h=()=>n(ea),e[0]=n,e[1]=h):h=e[1],o=h}const c=o;let u;e[2]!==s||e[3]!==t?(u=function(){return l.jsx(l.Fragment,{children:s&&l.jsx(ra,{...t})})},e[2]=s,e[3]=t,e[4]=u):u=e[4];const m=u;let d;e[5]!==s||e[6]!==c?(d={navigatorEnabled:s,toggleNavigator:c},e[5]=s,e[6]=c,e[7]=d):d=e[7];let p;return e[8]!==m||e[9]!==d?(p=[d,m],e[8]=m,e[9]=d,e[10]=p):p=e[10],p}function ea(r){return!r}function ta(r){const e=W.c(11),{minWidth:t,maxWidth:i,component:a}=r,n=t!=null&&i!=null&&t===i;let s;e[0]!==a?(s=l.jsx(a,{}),e[0]=a,e[1]=s):s=e[1];let o;e[2]!==i||e[3]!==t||e[4]!==s?(o=l.jsx(Tt,{id:"navigator",minWidth:t,maxWidth:i,order:1,children:s}),e[2]=i,e[3]=t,e[4]=s,e[5]=o):o=e[5];let c;e[6]!==n?(c=l.jsx(br,{order:2,disabled:n}),e[6]=n,e[7]=c):c=e[7];let u;return e[8]!==o||e[9]!==c?(u=l.jsxs(l.Fragment,{children:[o,c]}),e[8]=o,e[9]=c,e[10]=u):u=e[10],u}const ra=f.memo(ta),na=function(r){const e=W.c(3),{children:t,params:i}=r;let a;a=i;const n=a;let s;return e[0]!==t||e[1]!==n?(s=l.jsx(Gr.Provider,{value:n,children:t}),e[0]=t,e[1]=n,e[2]=s):s=e[2],s},ia=function(r){const e=W.c(10),{children:t,devMode:i,name:a,navigate:n,params:s,searchParams:o,structureParams:c}=r;let u,m;e[0]!==i||e[1]!==a||e[2]!==n||e[3]!==s||e[4]!==o||e[5]!==c?(m={devMode:i,name:a,navigate:n,params:s,searchParams:o,structureParams:c},e[0]=i,e[1]=a,e[2]=n,e[3]=s,e[4]=o,e[5]=c,e[6]=m):m=e[6],u=m;const d=u;let p;return e[7]!==t||e[8]!==d?(p=l.jsx(Kr.Provider,{value:d,children:t}),e[7]=t,e[8]=d,e[9]=p):p=e[9],p};function Mt(r){const e=ee(r,aa);if(!Array.isArray(e))throw new TypeError("allowPatterns must be an array");return e}function aa(r){return r.context.allowOrigins}function Fe(r){return Array.isArray(r)?r.join(","):r}function Pr(){const r=W.c(2),e=f.useId();let t;return r[0]!==e?(t=e.startsWith(":")?e.replace(/^:(.+):$/,"«$1»"):e,r[0]=e,r[1]=t):t=r[1],t}const sa=f.forwardRef(function(r,e){const t=W.c(19),{animate:i,initial:a,onLoad:n,preventClick:s,src:o,variants:c,style:u}=r,m=f.useRef(null);let d;t[0]===Symbol.for("react.memo_cache_sentinel")?(d=()=>m.current,t[0]=d):d=t[0],f.useImperativeHandle(e,d);let p,h;t[1]===Symbol.for("react.memo_cache_sentinel")?(p=()=>{if(!m.current)return;const y=m.current,b=function(){y===document.activeElement&&y.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0}))};return window.addEventListener("blur",b),()=>{window.removeEventListener("blur",b)}},h=[],t[1]=p,t[2]=h):(p=t[1],h=t[2]),f.useEffect(p,h);const x=Pr();let w;t[3]!==u||t[4]!==x?(w={...u,viewTransitionName:x},t[3]=u,t[4]=x,t[5]=w):w=t[5];let v;t[6]!==i||t[7]!==a||t[8]!==n||t[9]!==o||t[10]!==w||t[11]!==c?(v=l.jsx(oa,{style:w,animate:i,initial:a,onLoad:n,ref:m,src:o,variants:c}),t[6]=i,t[7]=a,t[8]=n,t[9]=o,t[10]=w,t[11]=c,t[12]=v):v=t[12];let g;t[13]!==s?(g=s&&l.jsx(ca,{}),t[13]=s,t[14]=g):g=t[14];let P;t[15]===Symbol.for("react.memo_cache_sentinel")?(P=l.jsx(la,{}),t[15]=P):P=t[15];let S;return t[16]!==v||t[17]!==g?(S=l.jsxs(l.Fragment,{children:[v,g,P]}),t[16]=v,t[17]=g,t[18]=S):S=t[18],S}),oa=qe.create(ge.iframe`
  box-shadow: 0 0 0 1px var(--card-border-color);
  border: 0;
  max-height: 100%;
  width: 100%;
  view-transition-class: presentation-tool-iframe;
`),ca=ge(ve)`
  position: absolute;
  inset: 0;
  background: transparent;
`,la=sn`
html:active-view-transition-type(sanity-iframe-viewport) {
  view-transition-name: none;
  &::view-transition {
    pointer-events: none;
  }
  /* &::view-transition-old(root) {
    display: none;
  }
  &::view-transition-new(root) {
    animation: none;
  } */
}
`;function ua(r){const e=W.c(16),{openPopup:t,previewLocationOrigin:i,previewLocationRoute:a,perspective:n,targetOrigin:s}=r;let o;const c=new URL(a,i||s);c.searchParams.set(Ne,Fe(n));const{pathname:u,search:m}=c;o=`${i}${u}${m}`;const d=o,{t:p}=xe(be);let h;e[0]!==t?(h=b=>{b.preventDefault(),t(b.currentTarget.href)},e[0]=t,e[1]=h):h=e[1];const x=h;let w;e[2]!==p?(w=p("share-url.menu-item.open.text"),e[2]=p,e[3]=w):w=e[3];let v;e[4]!==w?(v=l.jsx(re,{size:1,children:w}),e[4]=w,e[5]=v):v=e[5];let g;e[6]===Symbol.for("react.memo_cache_sentinel")?(g=["bottom-start"],e[6]=g):g=e[6];let P;e[7]!==p?(P=p("share-url.menu-item.open.text"),e[7]=p,e[8]=P):P=e[8];let S;e[9]!==x||e[10]!==d||e[11]!==P?(S=l.jsx(Re,{as:"a","aria-label":P,icon:Cn,mode:"bleed",href:d,rel:"opener",target:"_blank",tooltipProps:null,onClick:x}),e[9]=x,e[10]=d,e[11]=P,e[12]=S):S=e[12];let y;return e[13]!==v||e[14]!==S?(y=l.jsx(Ke,{animate:!0,content:v,fallbackPlacements:g,placement:"bottom",portal:!0,children:S}),e[13]=v,e[14]=S,e[15]=y):y=e[15],y}function Sr(r){const e=ee(r,da);if(!e)throw new TypeError("targetOrigin is required");return e}function da(r){var e;return(e=r.context.previewUrl)==null?void 0:e.origin}function pa(r){var G;const e=W.c(32),{fontSize:t,onChange:i,padding:a,prefix:n,suffix:s,value:o,previewUrlRef:c}=r,u=t===void 0?1:t,m=a===void 0?3:a,d=Mt(c),p=Sr(c),{t:h}=xe(be),{basePath:x}=((G=er())==null?void 0:G.activeWorkspace)||{},w=x===void 0?"/":x,v=f.useRef(null),[g,P]=f.useState(void 0),[S,y]=f.useState(void 0);let b;e[0]===Symbol.for("react.memo_cache_sentinel")?(b=q=>{P(q.currentTarget.value)},e[0]=b):b=e[0];const _=b;let A;e[1]!==d||e[2]!==w||e[3]!==i||e[4]!==g||e[5]!==h||e[6]!==p?(A=q=>{var ue;if(q.key==="Enter"){if(g===void 0)return;let Q;Q=g;try{Q=new URL(g,p).toString()}catch{}if(Array.isArray(d)){if(!d.some(oe=>oe.test(Q))){y(h("preview-location-input.error",{origin:p,context:"origin-not-allowed"})),q.currentTarget.reportValidity();return}}else if(!p&&(Q.startsWith(`${w}/`)||Q===w)){y(h("preview-location-input.error",{basePath:w,context:"same-base-path"}));return}const ne=Q===p?`${p}/`:Q;y(void 0),P(void 0),i(ne),(ue=v.current)==null||ue.blur()}q.key==="Escape"&&(y(void 0),P(void 0))},e[1]=d,e[2]=w,e[3]=i,e[4]=g,e[5]=h,e[6]=p,e[7]=A):A=e[7];const j=A;let C;e[8]===Symbol.for("react.memo_cache_sentinel")?(C=()=>{y(void 0),P(void 0)},e[8]=C):C=e[8];const R=C;let E;e[9]!==p||e[10]!==o?(E=()=>{y(void 0);let q=o;try{q=new URL(o,p).toString()}catch{}P(q)},e[9]=p,e[10]=o,e[11]=E):E=e[11];const U=E;let I;e[12]===Symbol.for("react.memo_cache_sentinel")?(I=()=>{y(void 0),P(void 0)},e[12]=I):I=e[12];let T;e[13]!==p||e[14]!==o?(T=[p,o],e[13]=p,e[14]=o,e[15]=T):T=e[15],f.useEffect(I,T);let k,z;e[16]===Symbol.for("react.memo_cache_sentinel")?(z={icon:An},e[16]=z):z=e[16],k=z;const D=S?k:void 0;let B;e[17]===Symbol.for("react.memo_cache_sentinel")?(B={zIndex:1},e[17]=B):B=e[17];let X;e[18]!==g||e[19]!==p||e[20]!==o?(X=g===void 0?new URL(o,p).toString():g,e[18]=g,e[19]=p,e[20]=o,e[21]=X):X=e[21];let se;return e[22]!==S||e[23]!==u||e[24]!==U||e[25]!==j||e[26]!==m||e[27]!==n||e[28]!==s||e[29]!==D||e[30]!==X?(se=l.jsx(l.Fragment,{children:l.jsx(Pn,{clearButton:D,customValidity:S,fontSize:u,onBlur:R,onClear:U,onChange:_,onKeyDownCapture:j,padding:m,prefix:n,style:B,radius:2,ref:v,space:m,suffix:s,value:X})}),e[22]=S,e[23]=u,e[24]=U,e[25]=j,e[26]=m,e[27]=n,e[28]=s,e[29]=D,e[30]=X,e[31]=se):se=e[31],se}const ma=f.lazy(()=>Ce(()=>import("./QRCodeSVG-ZmfxE8om.js"),__vite__mapDeps([0,1]))),yt=24,ha=16,fa=224,va=ge(Tn)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: ${yt}px;
  width: ${yt}px;
`,ga=qe.create(Ze),wa=qe.create(re),ya=qe.create(va),_r=f.memo(function(r){const{canToggleSharePreviewAccess:e,canUseSharedPreviewAccess:t,initialUrl:i,previewLocationRoute:a,perspective:n}=r,{t:s}=xe(be),{push:o}=it(),c=nt({apiVersion:ot}),u=Zt(),[m,d]=f.useState(!0),[p,h]=f.useState(!1),[x,w]=f.useState(!1),[v,g]=f.useState(null),P=p||x||m,S=f.useMemo(()=>v?Gn(i,v,a,Fe(n)):null,[i,n,a,v]),[y,b]=f.useState(null);if(y)throw y;const _=f.useCallback(()=>{o({closable:!0,status:"warning",title:s("share-preview-menu.error_toggle-sharing",{context:"toggle-sharing"})})},[o,s]),A=f.useCallback(async()=>{try{w(!0),await Xn(c,"sanity/presentation",typeof window>"u"?"":location.href,u==null?void 0:u.id),g(null)}catch(R){b(R)}finally{w(!1)}},[c,u==null?void 0:u.id]),j=f.useCallback(async()=>{try{h(!0);const R=await qn(c,"sanity/presentation",typeof window>"u"?"":location.href,u==null?void 0:u.id);g(R.secret)}catch(R){b(R)}finally{h(!1)}},[c,u==null?void 0:u.id]),C=f.useCallback(()=>{try{if(!S)throw new Error("No URL to copy");navigator.clipboard.writeText(S.toString()),o({closable:!0,status:"success",title:s("share-url.clipboard.status",{context:"success"})})}catch(R){b(R)}},[o,s,S]);return f.useEffect(()=>{let R=new AbortController,E=[];async function U(T,k){const{result:z,syncTags:D}=await c.fetch(lr,{},{filterResponse:!1,lastLiveEventId:T,tag:"presentation.fetch-shared-access-secret"});Array.isArray(D)&&(E=D),k.aborted||g(z)}const I=c.live.events().subscribe({next:T=>{T.type==="message"&&(R.abort(),R=new AbortController,T.tags.some(k=>E.includes(k))&&U(T.id,R.signal))},error:b});return U(null,R.signal).finally(()=>d(!1)),()=>{I.unsubscribe(),R.abort()}},[c]),l.jsx(on,{button:l.jsx(Re,{"aria-label":s("preview-frame.share-button.aria-label"),icon:mn,mode:"bleed",tooltipProps:null}),id:"share-menu",menu:l.jsx(cn,{style:{maxWidth:248},padding:t?void 0:0,children:t?l.jsxs(l.Fragment,{children:[l.jsx("label",{style:{cursor:"pointer"},children:l.jsxs(ln,{columns:2,rows:2,gapX:3,gapY:1,style:{justifyContent:"center",alignItems:"center",gridTemplateColumns:"min-content 1fr",gridTemplateRows:"min-content"},paddingTop:3,paddingX:3,children:[l.jsx(Ke,{animate:!0,content:l.jsx(re,{size:1,children:s("share-preview-menu.toggle-button.tooltip",{context:S?"disable":"enable"})}),fallbackPlacements:["bottom-start"],placement:"bottom",portal:!0,children:l.jsx(cr,{checked:p||S!==null&&!x,readOnly:p||x,indeterminate:m,onChange:e?S?A:j:_})}),l.jsx(re,{size:1,weight:"medium",children:s("share-preview-menu.toggle-button.label",{context:"first-line"})}),l.jsx("span",{}),l.jsx(re,{muted:!0,size:1,children:s("share-preview-menu.toggle-button.label",{context:"second-line"})})]})}),l.jsx(ve,{padding:3,paddingTop:2,children:l.jsxs(Ue,{space:3,children:[l.jsx(pe,{tone:P||!S?"transparent":void 0,style:{position:"relative",aspectRatio:"1 / 1",display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsx(or,{children:P?l.jsx(ga,{muted:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}):S?l.jsx(l.Fragment,{children:l.jsxs(f.Suspense,{fallback:l.jsx(Ze,{}),children:[l.jsx(ma,{title:s("share-preview-menu.qr-code.title",{url:S.toString()}),value:S.toString(),size:fa,color:"var(--card-fg-color)",logoSize:yt+ha}),l.jsx(ya,{initial:{opacity:-.5},animate:{opacity:1.5},exit:{opacity:0}})]})}):l.jsx(wa,{muted:!0,size:1,style:{maxWidth:"100px",textWrap:"pretty",textAlign:"center"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:s("share-preview-menu.qr-code.placeholder")})})}),l.jsx(re,{muted:!0,size:1,children:s("share-preview-menu.qr-code.instructions")})]})}),l.jsx(un,{}),l.jsx(dn,{disabled:!S||x,icon:pn,onClick:C,text:s("share-preview-menu.copy-url.text")})]}):l.jsx(pe,{padding:2,tone:"caution",radius:3,children:l.jsx(re,{style:{textWrap:"pretty"},children:s("share-preview-menu.error",{context:"missing-grants"})})})}),popover:{constrainSize:!0,placement:"bottom",portal:!0}})});_r.displayName="Memo(SharePreviewMenu)";const xa=r=>{const e=W.c(107),{canSharePreviewAccess:t,canToggleSharePreviewAccess:i,canUseSharedPreviewAccess:a,iframeRef:n,initialUrl:s,navigatorEnabled:o,onPathChange:c,onRefresh:u,openPopup:m,overlaysConnection:d,presentationRef:p,perspective:h,previewUrl:x,setViewport:w,targetOrigin:v,toggleNavigator:g,toggleOverlay:P,viewport:S,previewUrlRef:y}=r,{t:b}=xe(be);let _;e[0]!==w||e[1]!==S?(_=()=>w(S==="desktop"?"mobile":"desktop"),e[0]=w,e[1]=S,e[2]=_):_=e[2];const A=_;let j;j=v===location.origin?"":v;const C=j;let R;e[3]!==n||e[4]!==u||e[5]!==p||e[6]!==x||e[7]!==v?(R=()=>{u(()=>{n.current&&(p.send({type:"iframe reload"}),Object.assign(n.current,{src:`${v}${x||"/"}`}))})},e[3]=n,e[4]=u,e[5]=p,e[6]=x,e[7]=v,e[8]=R):R=e[8];const E=R,U=ee(p,Sa),I=ee(p,_a),T=ee(p,ja),k=ee(p,Ea),z=ee(p,Ra);let D;const B=new URL(x||"/",v),{pathname:X,search:se}=Hn(B);D=`${X}${se}`;const G=D,q=Pr(),ue=ee(y,Ca);let Q;e[9]===Symbol.for("react.memo_cache_sentinel")?(Q={width:"100%"},e[9]=Q):Q=e[9];let ne;e[10]!==o||e[11]!==b||e[12]!==g?(ne=g&&l.jsx(Re,{"aria-label":b("preview-frame.navigator.toggle-button.aria-label"),icon:en,mode:"bleed",onClick:g,selected:o,tooltipProps:{content:l.jsx(re,{size:1,children:b("preview-frame.navigator.toggle-button.tooltip")}),fallbackPlacements:["bottom-start"],placement:"bottom"}}),e[10]=o,e[11]=b,e[12]=g,e[13]=ne):ne=e[13];let oe;e[14]===Symbol.for("react.memo_cache_sentinel")?(oe={whiteSpace:"nowrap"},e[14]=oe):oe=e[14];const Y=z?"disable":"enable";let ce;e[15]!==b||e[16]!==Y?(ce=b("preview-frame.overlay.toggle-button.tooltip",{context:Y}),e[15]=b,e[16]=Y,e[17]=ce):ce=e[17];let F;e[18]!==ce?(F=l.jsx(ve,{padding:1,children:l.jsx(re,{size:1,children:ce})}),e[18]=ce,e[19]=F):F=e[19];let K;e[20]===Symbol.for("react.memo_cache_sentinel")?(K=l.jsx(ve,{paddingY:1,children:l.jsx(hn,{keys:["Alt"],style:{marginTop:-4,marginBottom:-4}})}),e[20]=K):K=e[20];let H;e[21]!==F?(H=l.jsxs(ae,{align:"center",style:oe,children:[F,K]}),e[21]=F,e[22]=H):H=e[22];let J;e[23]===Symbol.for("react.memo_cache_sentinel")?(J=["bottom-start"],e[23]=J):J=e[23];let $;e[24]===Symbol.for("react.memo_cache_sentinel")?($={lineHeight:0,borderRadius:999,userSelect:"none"},e[24]=$):$=e[24];const V=z?"transparent":void 0;let N;e[25]===Symbol.for("react.memo_cache_sentinel")?(N={margin:-4},e[25]=N):N=e[25];const Z=!I,le=U||d!=="connected";let me;e[26]!==z||e[27]!==Z||e[28]!==le||e[29]!==P?(me=l.jsx("div",{style:N,children:l.jsx(cr,{indeterminate:Z,checked:z,onChange:P,disabled:le})}),e[26]=z,e[27]=Z,e[28]=le,e[29]=P,e[30]=me):me=e[30];const Ae=!z;let Pe;e[31]!==b?(Pe=b("preview-frame.overlay.toggle-button.text"),e[31]=b,e[32]=Pe):Pe=e[32];let Se;e[33]!==Ae||e[34]!==Pe?(Se=l.jsx(ve,{children:l.jsx(re,{muted:Ae,size:1,weight:"medium",children:Pe})}),e[33]=Ae,e[34]=Pe,e[35]=Se):Se=e[35];let fe;e[36]!==me||e[37]!==Se?(fe=l.jsxs(ae,{align:"center",gap:3,children:[me,Se]}),e[36]=me,e[37]=Se,e[38]=fe):fe=e[38];let _e;e[39]!==V||e[40]!==fe?(_e=l.jsx(pe,{as:"label",flex:"none",padding:3,marginX:1,style:$,tone:V,children:fe}),e[39]=V,e[40]=fe,e[41]=_e):_e=e[41];let we;e[42]!==H||e[43]!==_e?(we=l.jsx(Ke,{animate:!0,content:H,fallbackPlacements:J,placement:"bottom",portal:!0,children:_e}),e[42]=H,e[43]=_e,e[44]=we):we=e[44];let Te;e[45]!==I||e[46]!==U||e[47]!==T||e[48]!==k||e[49]!==b?(Te=I?b("preview-frame.refresh-button.tooltip"):b("preview-frame.status",{context:U?"loading":T?"refreshing":k?"reloading":"unknown"}),e[45]=I,e[46]=U,e[47]=T,e[48]=k,e[49]=b,e[50]=Te):Te=e[50];let ke;e[51]!==Te?(ke=l.jsx(re,{size:1,children:Te}),e[51]=Te,e[52]=ke):ke=e[52];let $e;e[53]===Symbol.for("react.memo_cache_sentinel")?($e=["bottom-end"],e[53]=$e):$e=e[53];let Ee;e[54]!==b?(Ee=b("preview-frame.refresh-button.aria-label"),e[54]=b,e[55]=Ee):Ee=e[55];const Le=k||T||ue;let M;e[56]!==E||e[57]!==Ee||e[58]!==Le?(M=l.jsx(Re,{"aria-label":Ee,icon:fn,mode:"bleed",loading:Le,onClick:E,tooltipProps:null}),e[56]=E,e[57]=Ee,e[58]=Le,e[59]=M):M=e[59];let O;e[60]!==ke||e[61]!==M?(O=l.jsx(ve,{padding:1,children:l.jsx(Ke,{animate:!0,content:ke,fallbackPlacements:$e,placement:"bottom",portal:!0,children:M})}),e[60]=ke,e[61]=M,e[62]=O):O=e[62];let L;e[63]!==m||e[64]!==h||e[65]!==C||e[66]!==G||e[67]!==v?(L=l.jsx(ve,{padding:1,children:l.jsx(ua,{openPopup:m,previewLocationOrigin:C,previewLocationRoute:G,perspective:h,targetOrigin:v})}),e[63]=m,e[64]=h,e[65]=C,e[66]=G,e[67]=v,e[68]=L):L=e[68];let je;e[69]!==c||e[70]!==G||e[71]!==y||e[72]!==O||e[73]!==L?(je=l.jsx(ve,{flex:1,children:l.jsx(pa,{previewUrlRef:y,prefix:O,onChange:c,suffix:L,value:G})}),e[69]=c,e[70]=G,e[71]=y,e[72]=O,e[73]=L,e[74]=je):je=e[74];let de;e[75]!==q?(de=lt=>{lt==null||lt.style.setProperty("view-transition-name",q)},e[75]=q,e[76]=de):de=e[76];const Ve=S==="desktop"?"narrow":"full";let Me;e[77]!==b||e[78]!==Ve?(Me=b("preview-frame.viewport-button.tooltip",{context:Ve}),e[77]=b,e[78]=Ve,e[79]=Me):Me=e[79];let ye;e[80]!==Me?(ye=l.jsx(re,{size:1,children:Me}),e[80]=Me,e[81]=ye):ye=e[81];let Xe;e[82]===Symbol.for("react.memo_cache_sentinel")?(Xe=["bottom-start"],e[82]=Xe):Xe=e[82];let Oe;e[83]!==b?(Oe=b("preview-frame.viewport-button.aria-label"),e[83]=b,e[84]=Oe):Oe=e[84];const ct=S==="desktop"?tn:rn;let ze;e[85]!==Oe||e[86]!==ct||e[87]!==A||e[88]!==S?(ze=l.jsx(Re,{"data-testid":"preview-viewport-toggle","data-viewport":S,"aria-label":Oe,icon:ct,mode:"bleed",onClick:A,tooltipProps:null}),e[85]=Oe,e[86]=ct,e[87]=A,e[88]=S,e[89]=ze):ze=e[89];let We;e[90]!==de||e[91]!==ye||e[92]!==ze?(We=l.jsx(ae,{align:"center",flex:"none",gap:1,children:l.jsx(Ke,{animate:!0,ref:de,content:ye,fallbackPlacements:Xe,placement:"bottom",portal:!0,children:ze})}),e[90]=de,e[91]=ye,e[92]=ze,e[93]=We):We=e[93];let De;e[94]!==t||e[95]!==i||e[96]!==a||e[97]!==s||e[98]!==h||e[99]!==G?(De=t&&l.jsx(ae,{align:"center",flex:"none",gap:1,children:l.jsx(_r,{canToggleSharePreviewAccess:i,canUseSharedPreviewAccess:a,previewLocationRoute:G,initialUrl:s,perspective:h})}),e[94]=t,e[95]=i,e[96]=a,e[97]=s,e[98]=h,e[99]=G,e[100]=De):De=e[100];let Qe;return e[101]!==we||e[102]!==je||e[103]!==We||e[104]!==De||e[105]!==ne?(Qe=l.jsxs(ae,{align:"center",gap:1,paddingX:1,style:Q,children:[ne,we,je,We,De]}),e[101]=we,e[102]=je,e[103]=We,e[104]=De,e[105]=ne,e[106]=Qe):Qe=e[106],Qe};function ba(r){var u;const e=W.c(7),t=Pa,i=(u=r.options)==null?void 0:u.component;let a;e[0]!==i||e[1]!==r?(a=i?l.jsx(i,{...r,renderDefault:t}):t(r),e[0]=i,e[1]=r,e[2]=a):a=e[2];const n=a;let s;e[3]===Symbol.for("react.memo_cache_sentinel")?(s={position:"relative"},e[3]=s):s=e[3];let o;e[4]===Symbol.for("react.memo_cache_sentinel")?(o={minHeight:0},e[4]=o):o=e[4];let c;return e[5]!==n?(c=l.jsx(pe,{flex:"none",padding:2,borderBottom:!0,style:s,children:l.jsx(ae,{align:"center",style:o,children:n})}),e[5]=n,e[6]=c):c=e[6],c}function Pa(r){return l.jsx(xa,{...r})}function Sa(r){return r.matches("loading")}function _a(r){return r.matches("loaded")}function ja(r){return r.matches({loaded:"refreshing"})}function Ea(r){return r.matches({loaded:"reloading"})}function Ra(r){return r.context.visualEditingOverlaysEnabled}function Ca(r){return r.hasTag("busy")}const pt=qe.create(ae),jr=f.memo(f.forwardRef(function(r,e){const{header:t,initialUrl:i,loadersConnection:a,overlaysConnection:n,perspective:s,viewport:o,vercelProtectionBypass:c,presentationRef:u,previewUrlRef:m}=r,[d,p]=f.useState(null),h=Fe(d===null?s:d),x=f.useMemo(()=>{const $=new URL(i);return $.searchParams.get(Ne)||$.searchParams.set(Ne,h),(c||$.searchParams.get(Be))&&$.searchParams.set(Pt,"samesitenone"),c&&!$.searchParams.get(Be)&&$.searchParams.set(Be,c),$},[i,h,c]);f.useEffect(()=>{a==="connected"&&p($=>$===null?s:$)},[a,s]);const{t:w}=xe(be),{devMode:v}=Ct(),g=Xr(),P=f.useRef(null),S=l.jsx(ba,{...r,iframeRef:P,options:t});f.useImperativeHandle(e,()=>P.current);const y=ee(u,$=>$.matches("loading")||$.matches({loaded:"reloading"})),[b,_]=f.useState(!1),A=ee(u,$=>$.matches({loaded:"refreshing"})),[j,C]=f.useState(!1),R=y||A||n==="connecting",E=f.useCallback(()=>{P.current&&(P.current.src=x.toString(),u.send({type:"iframe reload"}))},[u,x]),U=f.useCallback(()=>{T(!0)},[]),[I,T]=f.useState(!1),[k,z]=f.useState(!1);f.useEffect(()=>{if(!(y||A)&&(n==="connecting"||n==="reconnecting")){const $=setTimeout(()=>{z(!0)},5e3);return()=>clearTimeout($)}},[n,y,A]),f.useEffect(()=>{if(!(y||A||!k)){if(n==="connected"&&(C(!1),z(!1),_(!1),T(!1)),n==="connecting"){const $=setTimeout(()=>{_(!0),console.error("Unable to connect to visual editing. Make sure you've setup '@sanity/visual-editing' correctly")},$t);return()=>clearTimeout($)}if(n==="reconnecting"){const $=setTimeout(()=>{_(!0),C(!0)},$t);return()=>clearTimeout($)}}},[y,n,A,k]);const D=f.useCallback(()=>{u.send({type:"iframe loaded"})},[u]),B=f.useMemo(()=>(y||n==="connecting"&&!A)&&!I,[I,y,A,n]),X=f.useSyncExternalStore(f.useCallback(()=>()=>{},[]),()=>CSS.supports("(view-transition-name: test)")),se=f.useMemo(()=>[B?"background":"active",y?"reloading":"idle",X?"":o,k&&!I?"timedOut":""],[X,I,y,B,k,o]),[G,q]=f.useState(o),[ue,Q]=f.useState(mt[o]);f.useEffect(()=>{if(X&&o!==G){const $=()=>{q(o),Q(mt[o])};!g&&"startViewTransition"in document&&typeof document.startViewTransition=="function"?document.startViewTransition({update:()=>Qr.flushSync(()=>$()),types:["sanity-iframe-viewport"]}):$()}},[X,g,G,o]);const ne=it(),oe=Mt(m),[Y,ce]=f.useState(!1),[F]=f.useState(new Set),K=Ye($=>{if(oe.some(V=>V.test($))){ce($);return}F.has($)||(F.add($),console.warn("Visual Editing is here but misconfigured",{reportedOrigin:$}),ne.push({closable:!0,id:`presentation-iframe-origin-mismatch-${$}`,status:"error",duration:1/0,title:w("preview-frame.configuration.error.title"),description:l.jsx(At,{t:w,i18nKey:"preview-frame.configuration.error.description",components:{Code:"code"},values:{targetOrigin:x.origin,reportedOrigin:$}})}))}),H=Jr(),J=Ye($=>{if(!Y)return;const V=new URL($,Y);H(`${Y}${V.pathname}${V.search}${V.hash}`)});return f.useEffect(()=>{var le;if(!Y)return;const $=(le=P.current)==null?void 0:le.contentWindow;if(!$)return;const V=ar({targetOrigin:Y});V.addTarget($);const N=V.createChannel({name:"presentation",heartbeat:!0,connectTo:"visual-editing"},vt().provide({actors:gt()}));N.on("visual-editing/navigate",me=>{J(me.url)});const Z=N.start();return()=>{Z(),V.destroy()}},[Y]),f.useEffect(()=>{if(n==="connecting"||n==="reconnecting"){const $=setInterval(()=>{var N,Z;(Z=(N=P.current)==null?void 0:N.contentWindow)==null||Z.postMessage({domain:"sanity/channels",from:"presentation",type:"presentation/status"},"*")},1e3),V=new AbortController;return window.addEventListener("message",({data:N})=>{N&&typeof N=="object"&&"domain"in N&&N.domain==="sanity/channels"&&"type"in N&&N.type==="visual-editing/status"&&"data"in N&&typeof N.data=="object"&&N.data&&"origin"in N.data&&typeof N.data.origin=="string"&&K(N.data.origin)},{signal:V.signal}),()=>{V.abort(),clearInterval($)}}},[n,b]),l.jsx(Un,{transition:g?{duration:0}:void 0,children:l.jsxs(Yr,{children:[S,l.jsx(pe,{flex:1,tone:"transparent",children:l.jsxs(ae,{align:"center",height:"fill",justify:"center",padding:(X?G:o)==="desktop"?0:2,sizing:"border",style:{position:"relative",cursor:R?"wait":void 0},children:[l.jsx(or,{children:!j&&!y&&!A&&k&&!I?l.jsx(pt,{initial:"initial",animate:"animate",exit:"exit",variants:Dt,justify:"center",align:"center",style:{inset:"0",position:"absolute",backdropFilter:b?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",transition:"backdrop-filter 0.2s ease-in-out",WebkitBackdropFilter:b?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",WebkitTransition:"-webkit-backdrop-filter 0.2s ease-in-out",zIndex:1},children:l.jsxs(ae,{style:{...rt[o]},justify:"center",align:"center",direction:"column",gap:4,children:[b&&l.jsx(Re,{disabled:!0,mode:"ghost",text:w("preview-frame.continue-button.text"),style:{opacity:0}}),l.jsx(pe,{radius:2,tone:b?"caution":"inherit",padding:4,shadow:1,children:l.jsxs(ae,{justify:"center",align:"center",direction:"column",gap:4,children:[l.jsx(Ze,{muted:!0}),l.jsx(re,{muted:!0,size:1,children:b?w("preview-frame.status",{context:"timeout"}):w("preview-frame.status",{context:"connecting"})})]})}),b&&l.jsx(Re,{tone:"critical",onClick:U,text:w("preview-frame.continue-button.text")})]})}):(y||n==="connecting"&&!A)&&!I?l.jsx(pt,{initial:"initial",animate:"animate",exit:"exit",variants:Dt,justify:"center",align:"center",style:{inset:"0",position:"absolute"},children:l.jsxs(ae,{style:{...rt[o]},justify:"center",align:"center",direction:"column",gap:4,children:[l.jsx(Ze,{muted:!0}),l.jsx(re,{muted:!0,size:1,children:w("preview-frame.status",{context:"loading"})})]})}):j&&!I?l.jsx(pt,{initial:"initial",animate:"animate",exit:"exit",variants:Aa,justify:"center",align:"center",style:{background:"var(--card-bg-color)",inset:"0",position:"absolute"},children:l.jsx(kt,{flex:1,message:w("preview-frame.connection.error.text"),onRetry:E,onContinueAnyway:U,children:v&&l.jsxs(l.Fragment,{children:[n!=="connected"&&l.jsx(pe,{padding:3,radius:2,tone:"critical",children:l.jsxs(Ue,{space:3,children:[l.jsx(et,{muted:!0,size:0,children:w("preview-frame.overlay.connection-status.label")}),l.jsx(tt,{size:1,children:w("channel.status",{context:n})})]})}),a!=="connected"&&l.jsx(pe,{padding:3,radius:2,tone:"critical",children:l.jsxs(Ue,{space:3,children:[l.jsx(et,{muted:!0,size:0,children:w("preview-frame.loader.connection-status.label")}),l.jsx(tt,{size:1,children:w("channel.status",{context:a})})]})})]})})}):null}),l.jsx(sa,{animate:se,initial:["background"],onLoad:D,preventClick:B,ref:P,src:x.toString(),style:ue,variants:mt})]})})]})})}));jr.displayName="Memo(ForwardRef(Preview))";const rt={desktop:{width:"100%",height:"100%"},mobile:{width:375,height:650}},Dt={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},Aa={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},mt={desktop:{...rt.desktop,boxShadow:"0 0 0 0px var(--card-border-color)"},mobile:{...rt.mobile,boxShadow:"0 0 0 1px var(--card-border-color)"},background:{opacity:0,scale:1},idle:{scale:1},reloading:{scale:[1,1,1,.98]},active:{opacity:[0,0,1],scale:1},timedOut:{opacity:[0,0,1]}};function Ta(){let r=!1;return(...e)=>{r||(console.warn(...e),r=!0)}}const ka=Ta();function Ma(r,e){const t=W.c(9);Br(r);let i;t[0]===Symbol.for("react.memo_cache_sentinel")?(i={},t[0]=i):i=t[0];const[a,n]=f.useState(i);let s;t[1]===Symbol.for("react.memo_cache_sentinel")?(s={},t[1]=s):s=t[1];const[o,c]=f.useState(s),u=f.useRef("");let m;t[2]!==e?(m=(g,P,S)=>{const y=(S===void 0?[]:S).filter($a);(P==="published"?n:c)(b=>{const _={};for(const j of y)_[j._id]=j;if(u.current!==e.current.url)return u.current=e.current.url,{[g]:_};const A=b[g];return $n(A,_)?b:{...b,[g]:_}})},t[2]=e,t[3]=m):m=t[3];const d=m;let p;const h=r==="published"?a:o;let x;if(t[4]!==h){const g=Object.values(h).reduce(Ia,{});x=Object.values(g),t[4]=h,t[5]=x}else x=t[5];p=x;const w=p;let v;return t[6]!==w||t[7]!==d?(v=[w,d],t[6]=w,t[7]=d,t[8]=v):v=t[8],v}function Ia(r,e){return Object.values(e).forEach(t=>{r[t._id]=t}),r}function $a(r){return"_projectId"in r&&r._projectId?(ka("Cross dataset references are not supported yet, ignoring source document",r),!1):r}function Er(r,e){return r instanceof Function?r(e):r}function Ua(r,e){var t;if(r.resolve){const i=(t=r.resolve(e))==null?void 0:t.filter;return i?`// groq
*[${i}][0]{_id, _type}`:void 0}return"type"in r?`// groq
*[_type == "${r.type}"][0]{_id, _type}`:`// groq
*[${Er(r.filter,e)}][0]{_id, _type}`}function La(r,e){var t;return r.resolve?((t=r.resolve(e))==null?void 0:t.params)??e.params:"type"in r?{}:Er(r.params,e)??e.params}function Oa(r,e){const t=Array.isArray(r)?r:[r];for(r of t){let i,a=r;if(typeof r=="string")try{const n=new URL(r);i=n.origin,a=n.pathname}catch{}if(!(i&&e.origin!==i))try{const n=Yn(a,{decode:decodeURIComponent})(e.pathname);if(n){const{params:s,path:o}=n;return{origin:i,params:s,path:o}}}catch{throw new Error(`"${r}" is not a valid route pattern`)}}}function za(r){var _,A;const e=W.c(22),{navigate:t,navigationHistory:i,path:a,targetOrigin:n,resolvers:s}=r;let o;e[0]!==s?(o=s===void 0?[]:s,e[0]=s,e[1]=o):o=e[1];const c=o,{state:u}=Ge(),{perspectiveStack:m}=Et();let d;e[2]===Symbol.for("react.memo_cache_sentinel")?(d={apiVersion:ot},e[2]=d):d=e[2];const p=nt(d);let h;e[3]!==a||e[4]!==u?(h=a||((A=(_=u._searchParams)==null?void 0:_.find(Wa))==null?void 0:A[1])||"",e[3]=a,e[4]=u,e[5]=h):h=e[5];const x=h,[w,v]=f.useState(void 0),g=f.useRef(void 0);let P;e[6]!==t||e[7]!==i?(P=(j,C)=>{var R,E;(!j||g.current!==j._id)&&(v({document:j,path:C.pathname}),g.current=j==null?void 0:j._id,((R=i.at(-1))==null?void 0:R.id)===((E=i.at(-2))==null?void 0:E.id)&&(t==null||t({id:j==null?void 0:j._id,type:j==null?void 0:j._type})))},e[6]=t,e[7]=i,e[8]=P):P=e[8];const S=Ye(P);let y;e[9]!==p||e[10]!==S||e[11]!==m||e[12]!==x||e[13]!==c||e[14]!==n?(y=()=>{const j=new URL(x,n);if(c.length){let C;for(const R of c){const E=Oa(R.route,j);if(E){C={context:E,resolver:R};break}}if(C){const R=Ua(C.resolver,C.context),E=La(C.resolver,C.context);if(R){const U=new AbortController,I={perspective:m,signal:U.signal,tag:"use-main-document"};return p.fetch(R,E,I).then(T=>S(T,j)).catch(T=>{T instanceof Error&&T.name==="AbortError"||(v({document:void 0,path:j.pathname}),g.current=void 0)}),()=>{U.abort()}}}}v(void 0),g.current=void 0},e[9]=p,e[10]=S,e[11]=m,e[12]=x,e[13]=c,e[14]=n,e[15]=y):y=e[15];let b;return e[16]!==p||e[17]!==m||e[18]!==x||e[19]!==c||e[20]!==n?(b=[p,m,x,c,n],e[16]=p,e[17]=m,e[18]=x,e[19]=c,e[20]=n,e[21]=b):b=e[21],f.useEffect(y,b),w}function Wa(r){const[e]=r;return e==="preview"}const Da=/^([\w-]+):(0|[1-9][0-9]*)$/,Na=/^([\w-]+):([0-9]+),([0-9]+)$/,Fa=/^([\w-]+):([\w-]+)$/;function Va(r){const e=[];for(const t of r.split(".")){const i=Da.exec(t);if(i){e.push(i[1],Number(i[2]));continue}const a=Na.exec(t);if(a){e.push(a[1],[Number(a[2]),Number(a[3])]);continue}const n=Fa.exec(t);if(n){e.push(n[1],{_key:n[2]});continue}e.push(t)}return e}function Ba(r){var t;if(r===void 0)return;const e=(t=decodeURIComponent(r))==null?void 0:t.split(".");return e[0]==="drafts"&&e.shift(),e.join(".")}function Ka(r){if(r!==void 0)return sr.toString(Va(decodeURIComponent(r)))}function Ha(r){return{id:Ba(r.id),path:Ka(r.path),type:r.type}}function Je(r){return Object.fromEntries(Object.entries(r).filter(([,e])=>e!==void 0&&e!==""&&e!==null))}function Ga({initialPreviewUrl:r,routerNavigate:e,routerState:t,routerSearchParams:i,frameStateRef:a}){const n=f.useMemo(()=>{const{id:d,path:p,type:h}=Ha(t);return{id:d,type:h,path:p,preview:i.preview||r.toString(),perspective:i.perspective,viewport:i.viewport,inspect:i.inspect,rev:i.rev,since:i.since,template:i.template,templateParams:i.templateParams,view:i.view,pathKey:i.pathKey,instruction:i.instruction,comment:i.comment,changesInspectorTab:i.changesInspectorTab}},[t,i,r]),s=f.useMemo(()=>Je({inspect:n.inspect,path:n.path,rev:n.rev,since:n.since,template:n.template,templateParams:n.templateParams,view:n.view,pathKey:n.pathKey,instruction:n.instruction,comment:n.comment,changesInspectorTab:n.changesInspectorTab}),[n.changesInspectorTab,n.comment,n.inspect,n.instruction,n.path,n.pathKey,n.rev,n.since,n.template,n.templateParams,n.view]),o=f.useMemo(()=>Je({perspective:n.perspective,preview:n.preview,viewport:n.viewport}),[n.perspective,n.preview,n.viewport]),c=f.useRef(t);f.useEffect(()=>{c.current=t},[t]);const[u,m]=f.useState([t]);return{navigate:f.useCallback((d,p={},h)=>{d.id&&(d.id=at(d.id));const{_searchParams:x,...w}=c.current,v=(x||[]).reduce((y,[b,_])=>(y[b]=_,y),{}),g=Je({...w,...d}),P=Je({...v,...p});w.id!==g.id&&(delete P.template,delete P.templateParams),g._searchParams=Object.entries(P).reduce((y,[b,_])=>[...y,[b,_]],[]);const S=h??P.preview===a.current.url;m(y=>[...y,g]),e(g,{replace:S})},[e,a]),navigationHistory:u,params:n,searchParams:o,structureParams:s}}const qa=r=>{const e=W.c(10),[t,i]=f.useState(Xa);let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=d=>{const p=window.open(d,"_blank");p&&i(h=>new Set(h).add(p))},e[0]=a):a=e[0];const n=a;let s,o;e[1]!==r||e[2]!==t?(s=()=>{const d=[];if(t.size&&r)for(const p of t)p&&"closed"in p&&!p.closed&&d.push(r.addTarget(p));return()=>{d.forEach(Qa)}},o=[r,t],e[1]=r,e[2]=t,e[3]=s,e[4]=o):(s=e[3],o=e[4]),f.useEffect(s,o);let c,u;e[5]!==t?(c=()=>{if(t.size){const d=setInterval(()=>{const p=new Set;for(const h of t)h&&"closed"in h&&h.closed&&p.add(h);p.size&&i(h=>{const x=new Set(h);for(const w of p)x.delete(w);return x})},vn);return()=>{clearInterval(d)}}},u=[t],e[5]=t,e[6]=c,e[7]=u):(c=e[6],u=e[7]),f.useEffect(c,u);let m;return e[8]!==t?(m={popups:t,open:n},e[8]=t,e[9]=m):m=e[9],m};function Xa(){return new Set}function Qa(r){return r()}function Rr(){const{perspectiveStack:r,selectedPerspectiveName:e,selectedReleaseId:t}=Et();return t?r:e===void 0?"drafts":e}function ht(){const r=W.c(4);let e;r[0]===Symbol.for("react.memo_cache_sentinel")?(e=new Map,r[0]=e):e=r[0];const[t,i]=f.useState(e);let a;e:{const u=Array.from(t.values());if(u.find(Za)){a="connected";break e}const m=u.filter(Ya);if(m.length){a=m.some(Ja)?"connecting":"reconnecting";break e}a="idle"}const n=a;let s;r[1]===Symbol.for("react.memo_cache_sentinel")?(s=u=>{i(m=>{var p;const d=new Map(m);if(u.status==="disconnected")d.delete(u.connection);else{const h=((p=d.get(u.connection))==null?void 0:p.hasConnected)||u.status==="connected",x=u.status==="handshaking"?"connecting":u.status;d.set(u.connection,{status:x,hasConnected:h})}return d})},r[1]=s):s=r[1];const o=s;let c;return r[2]!==n?(c=[n,o],r[2]=n,r[3]=c):c=r[3],c}function Ja(r){const{hasConnected:e}=r;return!e}function Ya(r){const{status:e}=r;return e==="connecting"}function Za(r){const{status:e}=r;return e==="connected"}const es=f.lazy(()=>Ce(()=>import("./LiveQueries-Bz5sENWb.js"),__vite__mapDeps([2,1,3]))),ts=f.lazy(()=>Ce(()=>import("./PostMessageDocuments-DEb4GIeN.js"),__vite__mapDeps([4,1]))),rs=f.lazy(()=>Ce(()=>import("./PostMessageRefreshMutations-BhDq5GMu.js"),__vite__mapDeps([5,1]))),ns=f.lazy(()=>Ce(()=>import("./PostMessagePerspective-wEopQOCH.js"),__vite__mapDeps([6,1]))),is=f.lazy(()=>Ce(()=>import("./PostMessagePreviewSnapshots-B809A43z.js"),__vite__mapDeps([7,1]))),as=f.lazy(()=>Ce(()=>import("./PostMessageSchema-BMzQnHiu.js"),__vite__mapDeps([8,1]))),ss=f.lazy(()=>Ce(()=>import("./PostMessageTelemetry-BusKN-mD.js"),__vite__mapDeps([9,1]))),os=ge(ae)`
  overflow-x: auto;
`;function cs(r){var $e,Ee,Le;const{canToggleSharePreviewAccess:e,canUseSharedPreviewAccess:t,tool:i,vercelProtectionBypass:a,initialPreviewUrl:n,previewUrlRef:s}=r,o=Mt(s),c=Sr(s),u=($e=i.options)==null?void 0:$e.components,m=i.name||Lr,{unstable_navigator:d,unstable_header:p}=u||{},{navigate:h,state:x}=Ge(),w=ir(Object.fromEntries(x._searchParams||[])),v=Rr(),g=ee(s,M=>{var O;return((O=M.context.previewMode)==null?void 0:O.shareAccess)!==!1}),[P]=f.useState(()=>{var O;const M=(O=i.options)==null?void 0:O.devMode;return typeof M=="function"?M():typeof M=="boolean"?M:typeof window<"u"&&window.location.hostname==="localhost"}),S=f.useRef(null),[y,b]=f.useState(),[_,A]=f.useState(null),j=f.useRef({title:void 0,url:void 0}),{navigate:C,navigationHistory:R,params:E,searchParams:U,structureParams:I}=Ga({initialPreviewUrl:n,routerNavigate:h,routerState:x,routerSearchParams:w,frameStateRef:j}),T=f.useMemo(()=>vr(C,50),[C]),k=nr(li),z=f.useMemo(()=>E.viewport?"mobile":"desktop",[E.viewport]),[D,B]=Ma(v,j),X=Or(),se=zr(),G=za({navigate:C,navigationHistory:R,path:E.preview,targetOrigin:c,resolvers:(Le=(Ee=i.options)==null?void 0:Ee.resolve)==null?void 0:Le.mainDocuments}),[q,ue]=ht(),[Q,ne]=ht(),[oe,Y]=ht(),{open:ce}=qa(y),F=ee(k,M=>M.matches("loading"));f.useEffect(()=>{var L;const M=(L=S.current)==null?void 0:L.contentWindow;if(!M||F)return;const O=ar({targetOrigin:c});return O.addTarget(M),b(O),()=>{O.destroy(),b(void 0)}},[c,F]);const K=Ye((M,O,L)=>T(M,O,L));f.useEffect(()=>{if(!y)return;const M=y.createChannel({name:"presentation",heartbeat:!0,connectTo:"visual-editing"},vt().provide({actors:gt()}));M.on("visual-editing/focus",L=>{"id"in L&&K({type:L.type,id:L.id,path:L.path})}),M.on("visual-editing/navigate",L=>{const{title:je}=L;let de=L.url;if(!de.startsWith("http"))try{de=new URL(de,c).toString()}catch{}if(j.current.url!==de)try{const[Ve,Me]=de.split("?"),ye=new URLSearchParams(Me);ye.delete(Be),ye.delete(Pt),K({},{preview:`${Ve}${ye.size>0?"?":""}${ye}`})}catch{K({},{preview:de})}j.current={title:je,url:de}}),M.on("visual-editing/meta",L=>{j.current.title=L.title}),M.on("visual-editing/toggle",L=>{k.send({type:"toggle visual editing overlays",enabled:L.enabled})}),M.on("visual-editing/documents",L=>{B("visual-editing",L.perspective,L.documents)}),M.on("visual-editing/refreshing",L=>{L.source==="manual"?clearTimeout(fe.current):L.source==="mutation"&&k.send({type:"iframe refresh"})}),M.on("visual-editing/refreshed",()=>{k.send({type:"iframe loaded"})}),M.onStatus(ue);const O=M.start();return A(M),()=>{O(),A(null)}},[y,k,B,ue,c]),f.useEffect(()=>{if(!y)return;const M=y.createChannel({name:"presentation",connectTo:"preview-kit",heartbeat:!0},vt().provide({actors:gt()}));return M.onStatus(Y),M.on("preview-kit/documents",O=>{O.projectId===X&&O.dataset===se&&B("preview-kit",O.perspective,O.documents)}),M.start()},[y,se,X,B,Y,c]);const H=f.useCallback(M=>{T({path:sr.toString(M)},{},!0)},[T]),J=f.useCallback(M=>{const O=new URL(M,c),L=O.toString();E.preview!==L&&(Array.isArray(o)?o.some(je=>je.test(L))&&T({},{preview:L}):O.origin===c&&T({},{preview:L}))},[c,E.preview,o,T]),$=f.useCallback(M=>{T({},M)},[T]);f.useEffect(()=>{E.id&&E.path?_==null||_.post("presentation/focus",{id:E.id,path:E.path}):_==null||_.post("presentation/blur")},[E.id,E.path,_]),f.useEffect(()=>{if(j.current.url&&E.preview&&j.current.url!==E.preview){try{const M=new URL(j.current.url,c).origin,O=new URL(E.preview,c).origin;if(M!==O)return}catch{}if(j.current.url=E.preview,q==="connected"){let M=E.preview;if(M.startsWith("http"))try{const O=new URL(E.preview,c);M=O.pathname+O.search+O.hash}catch{}_==null||_.post("presentation/navigate",{url:M,type:"replace"})}}},[q,c,E.preview,_]);const V=f.useCallback(()=>_==null?void 0:_.post("presentation/toggle-overlay"),[_]),[N,Z]=f.useState(null);f.useEffect(()=>{const M=L=>{Nt(L)&&V()},O=L=>{Nt(L)&&V(),us(["mod","\\"],L)&&V()};return window.addEventListener("keydown",O),window.addEventListener("keyup",M),()=>{window.removeEventListener("keydown",O),window.removeEventListener("keyup",M)}},[V]);const[le,me]=f.useState(null),[{navigatorEnabled:Ae,toggleNavigator:Pe},Se]=Zi({unstable_navigator:d}),fe=f.useRef(void 0),_e=f.useCallback(M=>{if(k.send({type:"iframe refresh"}),_){fe.current=window.setTimeout(M,300),_.post("presentation/refresh",{source:"manual",livePreviewEnabled:oe==="connected"||Q==="connected"});return}M()},[Q,k,oe,_]),we=Wr(),Te=f.useCallback(({id:M,type:O,path:L})=>{if(j.current.url)return{title:j.current.title||j.current.url,name:"edit",params:{id:M,path:L,type:O,inspect:Nr,workspace:we.name,mode:Dr,preview:E.preview}}},[E.preview,we.name]),ke=f.useCallback(M=>{T({},{viewport:M==="desktop"?void 0:"mobile"},!0)},[T]);return l.jsxs(l.Fragment,{children:[l.jsx(ia,{devMode:P,name:m,navigate:T,params:E,searchParams:U,structureParams:I,children:l.jsx(Ji,{navigate:T,children:l.jsx(na,{params:E,children:l.jsx(ui,{comlink:_,children:l.jsx(os,{"data-testid":"presentation-root",height:"fill",children:l.jsxs(bi,{children:[l.jsx(Se,{}),l.jsx(Tt,{id:"preview",minWidth:325,defaultSize:Ae?50:75,order:3,children:l.jsx(ae,{direction:"column",flex:1,height:"fill",ref:me,children:l.jsx(Fr,{element:le,children:l.jsx(jr,{canSharePreviewAccess:g,canToggleSharePreviewAccess:e,canUseSharedPreviewAccess:t,header:p,initialUrl:n,loadersConnection:Q,navigatorEnabled:Ae,onPathChange:J,onRefresh:_e,openPopup:ce,overlaysConnection:q,previewUrl:E.preview,perspective:v,ref:S,setViewport:ke,targetOrigin:c,toggleNavigator:Pe,toggleOverlay:V,viewport:z,vercelProtectionBypass:a,presentationRef:k,previewUrlRef:s},c)})})}),l.jsx(Qi,{documentId:E.id,documentsOnPage:D,documentType:E.type,getCommentIntent:Te,mainDocumentState:G,onFocusPath:H,onStructureParams:$,searchParams:U,setDisplayedDocument:Z,structureParams:I})]})})})})})}),l.jsxs(f.Suspense,{children:[y&&l.jsx(es,{controller:y,perspective:v,liveDocument:N,onDocumentsOnPage:B,onLoadersConnection:ne}),_&&E.id&&E.type&&l.jsx(rs,{comlink:_,id:E.id,type:E.type,loadersConnection:Q,previewKitConnection:oe}),_&&l.jsx(as,{comlink:_,perspective:v}),_&&D.length>0&&l.jsx(is,{comlink:_,perspective:v,refs:D}),_&&l.jsx(ts,{comlink:_,perspective:v}),_&&l.jsx(oi,{comlink:_}),_&&l.jsx(ns,{comlink:_,perspective:v}),_&&l.jsx(ss,{comlink:_})]})]})}function Nt(r){return r.key==="Alt"}const ls=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),Ft={alt:"altKey",ctrl:"ctrlKey",mod:ls?"metaKey":"ctrlKey",shift:"shiftKey"};function us(r,e){return r.every(t=>Ft[t]?e[Ft[t]]:e.key===t.toUpperCase())}function ds({client:r,currentUserId:e}){return he(async()=>await ii(r,"sanity/presentation",location.href,e))}function ps({client:r}){return he(async()=>r.fetch(lr,{},{tag:"presentation.fallback-to-shared-access-secret"}))}function ms({client:r,allowOption:e}){return he(async({input:t})=>{const{initialUrl:i}=t;if(typeof URLPattern>"u"&&await Ce(()=>import("./index-CEBgaQ5I.js"),[]),!e)return[new URLPattern(i.origin)];const a=typeof e=="function"?await e({client:r,origin,initialUrl:i}):e,n=(Array.isArray(a)?a:[a]).map(s=>{const o=new URLPattern(s);if(o.hostname==="*")throw new Error("It's insecure to allow any hostname, it could disclose data to a malicious site");return o});return n.some(s=>s.test(i.origin))?n:[...n,new URLPattern(i.origin)]})}function hs({client:r,studioBasePath:e,previewUrlOption:t,perspective:i}){return he(async({input:a})=>{const{origin:n}=location;if(typeof t=="function"){const s=await t({client:r,studioBasePath:e,previewUrlSecret:"",studioPreviewPerspective:Fe(i),previewSearchParam:a.previewSearchParam});return new URL(s,n)}if(!t)return new URL("/",n);if(typeof t=="string")return new URL(t,n);if(typeof t.initial=="function"){const s=await t.initial({client:r,origin:n});return new URL(s,n)}return typeof t.initial=="string"?new URL(t.initial,n):new URL(t.preview||"/",t.origin||n)})}function fs({client:r,previewUrlOption:e}){return he(async({input:t})=>{const{targetOrigin:i}=t;if(typeof e=="object"&&(e!=null&&e.draftMode))return{enable:e.draftMode.enable,shareAccess:e.draftMode.shareAccess??!0};if(!e||typeof e=="string"||typeof e=="function"||!e.previewMode)return!1;const a=typeof e.previewMode=="function"?await e.previewMode({client:r,origin,targetOrigin:i}):e.previewMode;return a===!1?!1:{enable:a.enable,shareAccess:a.shareAccess??!0}})}function vs({client:r,studioBasePath:e,previewUrlOption:t,perspective:i}){return he(async({input:a})=>{const{previewUrlSecret:n,resolvedPreviewMode:s,initialUrl:o}=a;if(typeof t=="function"){const u=await t({client:r,studioBasePath:e,previewUrlSecret:n,studioPreviewPerspective:Fe(i),previewSearchParam:o.toString()});return new URL(u,o)}if(!s)throw new Error("Resolved preview mode is false");const c=new URL(s.enable,o);return c.searchParams.set(bt,n),c.searchParams.set(Ne,Fe(i)),o.pathname!==c.pathname&&c.searchParams.set(xt,`${o.pathname}${o.search}${o.hash}`),c})}const gs=he(async({input:r})=>{const{previewSearchParam:e,initialUrl:t,allowOrigins:i}=r;if(!e)return t;try{const a=new URL(e,t.origin);return i.some(n=>n.test(a.origin))?a:t}catch{return t}}),ft={_id:He,_type:_t},ws={_id:`drafts.${Qt()}`,_type:Jt},ys=tr({actions:{"notify preview will likely fail":Vr("Missing permissions to create preview secret, or read shared preview secret. Preview will likely fail loading."),"assign preview search param":te({previewSearchParam:(r,e)=>e.previewSearchParam}),"assign error":te({error:(r,e)=>e.error instanceof Error?e.error:new Error(e.message,{cause:e.error})})},actors:{"check permission":rr(()=>kn(()=>new Error("The 'check permission' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'check permission': fromObservable(({input}: {input: CheckPermissionInput}) => ...)}})"))),"resolve initial url":he(()=>Promise.reject(new Error("The 'resolve initial url' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve initial url': fromPromise(...)}})"))),"resolve allow patterns":he(()=>Promise.reject(new Error("The 'resolve allow patterns' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve allow pattern': fromPromise(...)}})"))),"resolve url from preview search param":gs,"resolve preview mode":he(()=>Promise.reject(new Error("The 'resolve preview mode' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve preview mode': fromPromise(...)}})"))),"create preview secret":he(async()=>Promise.reject(new Error("The 'create preview secret' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'create preview secret': fromPromise(...)}})"))),"read shared preview secret":he(async()=>Promise.reject(new Error("The 'read shared preview secret' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'read shared preview secret': fromPromise(...)}})"))),"resolve preview mode url":he(()=>Promise.reject(new Error("The 'resolve preview mode url' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve preview mode url': fromPromise(...)}})")))},guards:{"has checked permissions":({context:r})=>!!(r.previewAccessSharingCreatePermission&&r.previewAccessSharingReadPermission&&r.previewAccessSharingUpdatePermission&&r.previewUrlSecretPermission),"search param has new origin":({context:r,event:e})=>{if(!r.previewUrl||!e.previewSearchParam)return!1;try{const t=new URL(e.previewSearchParam,r.previewUrl);return r.previewUrl.origin!==t.origin}catch{return!1}},"can create preview secret":({context:r})=>{var e;return((e=r.previewUrlSecretPermission)==null?void 0:e.granted)===!0},"has preview mode with created secret":({context:r},e)=>{var t;return e===!1?!1:((t=r.previewUrlSecretPermission)==null?void 0:t.granted)===!0},"has preview mode with share access":({context:r},e)=>{var t;return e===!1?!1:((t=r.previewAccessSharingReadPermission)==null?void 0:t.granted)===!0},"has preview mode without permissions":({context:r},e)=>{var t,i;return e===!1?!1:((t=r.previewAccessSharingReadPermission)==null?void 0:t.granted)===!1&&((i=r.previewUrlSecretPermission)==null?void 0:i.granted)===!1}},delays:{expiredSecret:({context:r})=>{var i;if(!((i=r.previewUrlSecret)!=null&&i.expiresAt))return 0;const e=Date.now(),t=r.previewUrlSecret.expiresAt.getTime();return Math.max(t-e,0)}}}).createMachine({id:"Preview URL",context:({input:r})=>({initialUrl:null,previewUrl:null,error:null,allowOrigins:null,previewSearchParam:r.previewSearchParam,previewUrlSecret:null,previewAccessSharingCreatePermission:null,previewAccessSharingReadPermission:null,previewAccessSharingUpdatePermission:null,previewUrlSecretPermission:null,previewMode:null}),invoke:[{src:"check permission",input:()=>({checkPermissionName:"read",document:ft}),onError:{target:".error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to check permission",error:r.error})}},onSnapshot:{actions:te({previewAccessSharingReadPermission:({event:r})=>r.snapshot.context??null})}},{src:"check permission",input:()=>({checkPermissionName:"create",document:ft}),onError:{target:".error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to check permission",error:r.error})}},onSnapshot:{actions:te({previewAccessSharingCreatePermission:({event:r})=>r.snapshot.context??null})}},{src:"check permission",input:()=>({checkPermissionName:"update",document:ft}),onError:{target:".error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to check permission",error:r.error})}},onSnapshot:{actions:te({previewAccessSharingUpdatePermission:({event:r})=>r.snapshot.context??null})}},{src:"check permission",input:()=>({checkPermissionName:"create",document:ws}),onError:{target:".error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to check permission",error:r.error})}},onSnapshot:{actions:te({previewUrlSecretPermission:({event:r})=>r.snapshot.context??null})}}],on:{"set preview search param":{actions:{type:"assign preview search param",params:({event:r})=>({previewSearchParam:r.previewSearchParam})}}},states:{checkingPermissions:{always:{guard:"has checked permissions",target:"resolvingInitialUrl"},tags:"busy"},resolvingInitialUrl:{invoke:{src:"resolve initial url",input:({context:r})=>({previewSearchParam:r.previewSearchParam}),onError:{target:"error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to resolve initial url",error:r.error})}},onDone:{target:"resolvingAllowPatterns",actions:te({initialUrl:({event:r})=>r.output})}},tags:"busy"},error:{type:"final",tags:"error"},resolvingAllowPatterns:{invoke:{src:"resolve allow patterns",input:({context:r})=>({initialUrl:r.initialUrl}),onError:{target:"error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to resolve preview url allow patterns",error:r.error})}},onDone:{target:"resolvingUrlFromPreviewSearchParam",actions:te({allowOrigins:({event:r})=>r.output})}},tags:["busy"]},resolvingUrlFromPreviewSearchParam:{id:"loop",invoke:{src:"resolve url from preview search param",input:({context:r})=>({initialUrl:r.initialUrl,allowOrigins:r.allowOrigins,previewSearchParam:r.previewSearchParam}),onError:{target:"error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to resolve preview url from search param",error:r.error})}},onDone:{target:"resolvingPreviewMode",actions:te({initialUrl:({event:r})=>r.output})}},tags:["busy"]},resolvingPreviewMode:{on:{"set preview search param":{guard:"search param has new origin",actions:{type:"assign preview search param",params:({event:r})=>({previewSearchParam:r.previewSearchParam})},target:"#loop",reenter:!0}},invoke:{src:"resolve preview mode",input:({context:r})=>({targetOrigin:r.initialUrl.origin}),onError:{target:"error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to resolve preview url allow patterns",error:r.error})}},onDone:[{guard:{type:"has preview mode with created secret",params:({event:r})=>r.output},actions:te({previewMode:({event:r})=>r.output}),target:"previewMode.createPreviewSecret"},{guard:{type:"has preview mode with share access",params:({event:r})=>r.output},actions:te({previewMode:({event:r})=>r.output}),target:"previewMode.readShareAccess"},{guard:{type:"has preview mode without permissions",params:({event:r})=>r.output},actions:[te({previewUrl:({context:r})=>r.initialUrl}),"notify preview will likely fail"],target:"success"},{actions:te({previewUrl:({context:r})=>r.initialUrl}),target:"success"}]},tags:["busy"]},success:{on:{"set preview search param":{guard:"search param has new origin",actions:{type:"assign preview search param",params:({event:r})=>({previewSearchParam:r.previewSearchParam})},target:"#loop",reenter:!0}}},previewMode:{on:{"set preview search param":{guard:"search param has new origin",actions:{type:"assign preview search param",params:({event:r})=>({previewSearchParam:r.previewSearchParam})},target:"#loop",reenter:!0}},states:{createPreviewSecret:{invoke:{src:"create preview secret",onError:{target:"error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to create preview secret",error:r.error})}},onDone:{target:"resolvePreviewUrl",actions:te({previewUrlSecret:({event:r})=>r.output})}},tags:["busy"]},readShareAccess:{invoke:{src:"read shared preview secret",onError:{target:"error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to read shared preview secret",error:r.error})}},onDone:{target:"resolvePreviewUrl",actions:te({previewUrlSecret:({event:r})=>({secret:r.output,expiresAt:new Date(Date.now()+1e3*60*60*60*24)})})}},tags:["busy"]},resolvePreviewUrl:{invoke:{src:"resolve preview mode url",input:({context:r})=>({initialUrl:r.initialUrl,resolvedPreviewMode:r.previewMode,previewUrlSecret:r.previewUrlSecret.secret}),onError:{target:"error",actions:{type:"assign error",params:({event:r})=>({message:"Failed to resolve preview url",error:r.error})}},onDone:{target:"success",actions:te({previewUrl:({event:r})=>r.output})}},tags:["busy"]},error:{type:"final",tags:["error"]},success:{after:{expiredSecret:{guard:"can create preview secret",actions:te({previewUrlSecret:null}),target:"createPreviewSecret",reenter:!0}}}},initial:"readShareAccess"}},initial:"checkingPermissions"});function xs(r,e){var y,b,_;const t=W.c(24),i=Ur();let a;t[0]===Symbol.for("react.memo_cache_sentinel")?(a={apiVersion:ot},t[0]=a):a=t[0];const n=nt(a),s=(y=Zt())==null?void 0:y.id,o=((_=(b=er())==null?void 0:b.activeWorkspace)==null?void 0:_.basePath)||"/",c=Ge();let u;t[1]!==c.state._searchParams?(u=new URLSearchParams(c.state._searchParams).get("preview"),t[1]=c.state._searchParams,t[2]=u):u=t[2];const m=u,{push:d}=it(),{t:p}=xe(be),h=Rr();let x;if(t[3]!==e||t[4]!==n||t[5]!==s||t[6]!==i||t[7]!==h||t[8]!==r||t[9]!==d||t[10]!==o||t[11]!==p){let A;t[13]!==d||t[14]!==p?(A=()=>d({id:"preview-url-secret.missing-grants",closable:!0,status:"error",duration:1/0,title:p("preview-url-secret.missing-grants")}),t[13]=d,t[14]=p,t[15]=A):A=t[15];let j;t[16]!==i?(j=C=>{const{input:R}=C;return i.checkDocumentPermission(R.checkPermissionName,R.document)},t[16]=i,t[17]=j):j=t[17],x=ys.provide({actions:{"notify preview will likely fail":A},actors:{"create preview secret":ds({client:n,currentUserId:s}),"read shared preview secret":ps({client:n}),"resolve allow patterns":ms({client:n,allowOption:e}),"resolve initial url":hs({client:n,studioBasePath:o,previewUrlOption:r,perspective:h}),"resolve preview mode":fs({client:n,previewUrlOption:r}),"resolve preview mode url":vs({client:n,studioBasePath:o,previewUrlOption:r,perspective:h}),"check permission":rr(j)}}),t[3]=e,t[4]=n,t[5]=s,t[6]=i,t[7]=h,t[8]=r,t[9]=d,t[10]=o,t[11]=p,t[12]=x}else x=t[12];let w;t[18]!==m?(w={input:{previewSearchParam:m}},t[18]=m,t[19]=w):w=t[19];const v=nr(x,w);let g,P;t[20]!==v||t[21]!==m?(g=()=>{v.send({type:"set preview search param",previewSearchParam:m})},P=[v,m],t[20]=v,t[21]=m,t[22]=g,t[23]=P):(g=t[22],P=t[23]),f.useEffect(g,P);const S=ee(v,bs);if(S)throw S;return v}function bs(r){return r.status==="error"?r.error:r.hasTag("error")?r.context.error:null}function Ps(r){const e=W.c(9),{t}=xe(be),{push:i}=it(),a=Ge();let n;e[0]!==a.state._searchParams?(n=new URLSearchParams(a.state._searchParams).get("preview"),e[0]=a.state._searchParams,e[1]=n):n=e[1];const s=n,o=ee(r,_s),c=ee(r,Ss);let u,m;e[2]!==o||e[3]!==c||e[4]!==s||e[5]!==i||e[6]!==t?(u=()=>{if(!Array.isArray(o)||!s||!c)return;const d=new URL(s,c).origin;o.some(p=>p.test(d))||i({closable:!0,id:`presentation-iframe-origin-mismatch-${d}`,status:"error",duration:1/0,title:t("preview-search-param.configuration.error.title"),description:l.jsx(At,{t,i18nKey:"preview-search-param.configuration.error.description",components:{Code:"code"},values:{previewSearchParam:s,blockedOrigin:d}})})},m=[o,c,s,i,t],e[2]=o,e[3]=c,e[4]=s,e[5]=i,e[6]=t,e[7]=u,e[8]=m):(u=e[7],m=e[8]),f.useEffect(u,m)}function Ss(r){var e;return(e=r.context.previewUrl)==null?void 0:e.origin}function _s(r){return r.context.allowOrigins}function js(){const r=W.c(7);let e;r[0]===Symbol.for("react.memo_cache_sentinel")?(e={apiVersion:ot},r[0]=e):e=r[0];const t=nt(e),[i,a]=f.useReducer(Es,"loading"),[n,s]=f.useState(null);let o,c;r[1]!==t?(o=()=>{const m=ai(t,d=>{s(d),a()});return()=>m()},c=[t],r[1]=t,r[2]=o,r[3]=c):(o=r[2],c=r[3]),f.useEffect(o,c);let u;return r[4]!==i||r[5]!==n?(u=[n,i],r[4]=i,r[5]=n,r[6]=u):u=r[6],u}function Es(){return"ready"}function Rs(r){var x,w;const e=W.c(8),{tool:t}=r,i=xs((x=t.options)==null?void 0:x.previewUrl,(w=t.options)==null?void 0:w.allowOrigins);Ps(i);const a=ee(i,Ms),n=ee(i,ks),s=ee(i,Ts),o=ee(i,As),c=ee(i,Cs),[u,m]=js();if(!c||m==="loading"||!a||typeof a.granted>"u"||!n||typeof n.granted>"u"||!o||!s||typeof s.granted>"u"||typeof o.granted>"u"){let v;return e[0]===Symbol.for("react.memo_cache_sentinel")?(v=l.jsx(Yt,{}),e[0]=v):v=e[0],v}const d=(a==null?void 0:a.granted)===!0&&(n==null?void 0:n.granted)===!0,p=(s==null?void 0:s.granted)===!0;let h;return e[1]!==i||e[2]!==d||e[3]!==p||e[4]!==t||e[5]!==c||e[6]!==u?(h=l.jsx(cs,{tool:t,initialPreviewUrl:c,vercelProtectionBypass:u,canToggleSharePreviewAccess:d,canUseSharedPreviewAccess:p,previewUrlRef:i}),e[1]=i,e[2]=d,e[3]=p,e[4]=t,e[5]=c,e[6]=u,e[7]=h):h=e[7],h}function Cs(r){return r.context.previewUrl}function As(r){return r.context.previewUrlSecretPermission}function Ts(r){return r.context.previewAccessSharingReadPermission}function ks(r){return r.context.previewAccessSharingUpdatePermission}function Ms(r){return r.context.previewAccessSharingCreatePermission}const Us=Object.freeze(Object.defineProperty({__proto__:null,default:Rs},Symbol.toStringTag,{value:"Module"}));export{Us as P,gt as c};
